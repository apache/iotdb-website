<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title> </title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/favicon.ico">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-5MM3J6X84E"></script>
    <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-5MM3J6X84E');</script>
    <meta name="description" content=" ">
    <meta name="Description" content="Apache IoTDB: Time Series Database for IoT">
    <meta name="Keywords" content="TSDB, time series, time series database, IoTDB, IoT database, IoT data management,时序数据库, 时间序列管理, IoTDB, 物联网数据库, 实时数据库, 物联网数据管理, 物联网数据">
    <meta name="baidu-site-verification" content="wfKETzB3OT">
    <meta name="google-site-verification" content="mZWAoRY0yj_HAr-s47zHCGHzx5Ju-RVm5wDbPnwQYFo">
    
    <link rel="preload" href="/assets/css/0.styles.b938c1b9.css" as="style"><link rel="preload" href="/assets/js/app.7e72c28b.js" as="script"><link rel="preload" href="/assets/js/3.c53a3153.js" as="script"><link rel="preload" href="/assets/js/4.8cacb85f.js" as="script"><link rel="preload" href="/assets/js/9.340bbf81.js" as="script"><link rel="prefetch" href="/assets/js/10.c3bbdea3.js"><link rel="prefetch" href="/assets/js/100.e5f65dad.js"><link rel="prefetch" href="/assets/js/101.2dfbbf92.js"><link rel="prefetch" href="/assets/js/102.f2817a8e.js"><link rel="prefetch" href="/assets/js/103.73e20456.js"><link rel="prefetch" href="/assets/js/104.e5139a41.js"><link rel="prefetch" href="/assets/js/105.940f795f.js"><link rel="prefetch" href="/assets/js/106.2db86759.js"><link rel="prefetch" href="/assets/js/107.586fa1c0.js"><link rel="prefetch" href="/assets/js/108.3d69fff2.js"><link rel="prefetch" href="/assets/js/109.bc22df26.js"><link rel="prefetch" href="/assets/js/11.c2123f8d.js"><link rel="prefetch" href="/assets/js/110.1148ad2e.js"><link rel="prefetch" href="/assets/js/111.7ed7fd10.js"><link rel="prefetch" href="/assets/js/112.bfc5657d.js"><link rel="prefetch" href="/assets/js/113.867d5368.js"><link rel="prefetch" href="/assets/js/114.97e900bb.js"><link rel="prefetch" href="/assets/js/115.0ec0a8c0.js"><link rel="prefetch" href="/assets/js/116.636ad01a.js"><link rel="prefetch" href="/assets/js/117.fe4f76d4.js"><link rel="prefetch" href="/assets/js/118.121906c0.js"><link rel="prefetch" href="/assets/js/119.5fc9ba1f.js"><link rel="prefetch" href="/assets/js/12.f383644c.js"><link rel="prefetch" href="/assets/js/120.488b55e0.js"><link rel="prefetch" href="/assets/js/121.e467077b.js"><link rel="prefetch" href="/assets/js/122.2e0295af.js"><link rel="prefetch" href="/assets/js/123.07730500.js"><link rel="prefetch" href="/assets/js/124.085dc79f.js"><link rel="prefetch" href="/assets/js/125.bc8c445e.js"><link rel="prefetch" href="/assets/js/126.af065d6e.js"><link rel="prefetch" href="/assets/js/127.5fadd4c6.js"><link rel="prefetch" href="/assets/js/128.04c162f6.js"><link rel="prefetch" href="/assets/js/129.c460c9b4.js"><link rel="prefetch" href="/assets/js/13.77b9aeea.js"><link rel="prefetch" href="/assets/js/130.ac5d9731.js"><link rel="prefetch" href="/assets/js/131.f4331759.js"><link rel="prefetch" href="/assets/js/132.e9260682.js"><link rel="prefetch" href="/assets/js/133.66bc8f6b.js"><link rel="prefetch" href="/assets/js/134.003ff179.js"><link rel="prefetch" href="/assets/js/135.cfb12408.js"><link rel="prefetch" href="/assets/js/136.0e0afd30.js"><link rel="prefetch" href="/assets/js/137.fc324bf8.js"><link rel="prefetch" href="/assets/js/138.dc333ab5.js"><link rel="prefetch" href="/assets/js/139.50db1ef4.js"><link rel="prefetch" href="/assets/js/14.bf1442b4.js"><link rel="prefetch" href="/assets/js/140.7994ea54.js"><link rel="prefetch" href="/assets/js/141.566fd41f.js"><link rel="prefetch" href="/assets/js/142.59c56ab3.js"><link rel="prefetch" href="/assets/js/143.b1aea799.js"><link rel="prefetch" href="/assets/js/144.3d776396.js"><link rel="prefetch" href="/assets/js/145.430a7076.js"><link rel="prefetch" href="/assets/js/146.4c8f3144.js"><link rel="prefetch" href="/assets/js/147.c2a0130f.js"><link rel="prefetch" href="/assets/js/148.704ef9f6.js"><link rel="prefetch" href="/assets/js/149.6ba53e0f.js"><link rel="prefetch" href="/assets/js/15.d5df9f03.js"><link rel="prefetch" href="/assets/js/150.89ffd0d3.js"><link rel="prefetch" href="/assets/js/151.2046b467.js"><link rel="prefetch" href="/assets/js/152.e0f34e06.js"><link rel="prefetch" href="/assets/js/153.b6ff23c7.js"><link rel="prefetch" href="/assets/js/154.1458db60.js"><link rel="prefetch" href="/assets/js/155.13b0da7c.js"><link rel="prefetch" href="/assets/js/156.d42240bc.js"><link rel="prefetch" href="/assets/js/157.e3a144eb.js"><link rel="prefetch" href="/assets/js/158.81910b20.js"><link rel="prefetch" href="/assets/js/159.18281892.js"><link rel="prefetch" href="/assets/js/16.ae8b77aa.js"><link rel="prefetch" href="/assets/js/160.31508f8d.js"><link rel="prefetch" href="/assets/js/161.8dde0462.js"><link rel="prefetch" href="/assets/js/162.21e4dc71.js"><link rel="prefetch" href="/assets/js/163.02832b14.js"><link rel="prefetch" href="/assets/js/164.4a83296c.js"><link rel="prefetch" href="/assets/js/165.95a967fc.js"><link rel="prefetch" href="/assets/js/166.117ff839.js"><link rel="prefetch" href="/assets/js/167.c64fbe4c.js"><link rel="prefetch" href="/assets/js/168.efd55552.js"><link rel="prefetch" href="/assets/js/169.ea11380a.js"><link rel="prefetch" href="/assets/js/17.aa850b1b.js"><link rel="prefetch" href="/assets/js/170.c1e25176.js"><link rel="prefetch" href="/assets/js/171.2a6a39ae.js"><link rel="prefetch" href="/assets/js/172.19a546e9.js"><link rel="prefetch" href="/assets/js/173.d6942769.js"><link rel="prefetch" href="/assets/js/174.1c02dfde.js"><link rel="prefetch" href="/assets/js/175.b50b0224.js"><link rel="prefetch" href="/assets/js/176.c6766161.js"><link rel="prefetch" href="/assets/js/177.bd053352.js"><link rel="prefetch" href="/assets/js/178.fd80b8cf.js"><link rel="prefetch" href="/assets/js/179.d36792fb.js"><link rel="prefetch" href="/assets/js/18.5ce3a556.js"><link rel="prefetch" href="/assets/js/180.b25c4781.js"><link rel="prefetch" href="/assets/js/181.f21a6006.js"><link rel="prefetch" href="/assets/js/182.1d71ff0b.js"><link rel="prefetch" href="/assets/js/183.47fc9443.js"><link rel="prefetch" href="/assets/js/184.bad6c742.js"><link rel="prefetch" href="/assets/js/185.c946b662.js"><link rel="prefetch" href="/assets/js/186.48288495.js"><link rel="prefetch" href="/assets/js/187.40257fec.js"><link rel="prefetch" href="/assets/js/188.fa38dda0.js"><link rel="prefetch" href="/assets/js/189.e1f81c46.js"><link rel="prefetch" href="/assets/js/19.3117e238.js"><link rel="prefetch" href="/assets/js/190.8cfda275.js"><link rel="prefetch" href="/assets/js/191.31ac12c8.js"><link rel="prefetch" href="/assets/js/192.534e4314.js"><link rel="prefetch" href="/assets/js/193.f8894159.js"><link rel="prefetch" href="/assets/js/194.3138e553.js"><link rel="prefetch" href="/assets/js/195.492b149e.js"><link rel="prefetch" href="/assets/js/196.4beed543.js"><link rel="prefetch" href="/assets/js/197.de422c5d.js"><link rel="prefetch" href="/assets/js/198.0d5f74d1.js"><link rel="prefetch" href="/assets/js/199.5347ed24.js"><link rel="prefetch" href="/assets/js/20.7d94ab0b.js"><link rel="prefetch" href="/assets/js/200.742cf234.js"><link rel="prefetch" href="/assets/js/201.4ef84d40.js"><link rel="prefetch" href="/assets/js/202.3f1000cb.js"><link rel="prefetch" href="/assets/js/203.85e9b5ea.js"><link rel="prefetch" href="/assets/js/204.1a5a5556.js"><link rel="prefetch" href="/assets/js/205.d333bbb8.js"><link rel="prefetch" href="/assets/js/206.83ea3403.js"><link rel="prefetch" href="/assets/js/207.e0f57b9a.js"><link rel="prefetch" href="/assets/js/208.054b286c.js"><link rel="prefetch" href="/assets/js/209.164630d7.js"><link rel="prefetch" href="/assets/js/21.ab1d6805.js"><link rel="prefetch" href="/assets/js/210.d71a993c.js"><link rel="prefetch" href="/assets/js/211.bda26c70.js"><link rel="prefetch" href="/assets/js/212.09d46746.js"><link rel="prefetch" href="/assets/js/213.fca71d73.js"><link rel="prefetch" href="/assets/js/214.2c7f1fa2.js"><link rel="prefetch" href="/assets/js/215.43c4ceb0.js"><link rel="prefetch" href="/assets/js/216.deafc42d.js"><link rel="prefetch" href="/assets/js/217.42411c24.js"><link rel="prefetch" href="/assets/js/218.5674b1fc.js"><link rel="prefetch" href="/assets/js/219.90542caa.js"><link rel="prefetch" href="/assets/js/22.21272861.js"><link rel="prefetch" href="/assets/js/220.211fb64c.js"><link rel="prefetch" href="/assets/js/221.bb8d609a.js"><link rel="prefetch" href="/assets/js/222.0e0e9754.js"><link rel="prefetch" href="/assets/js/223.99aa74fd.js"><link rel="prefetch" href="/assets/js/224.6944bc8f.js"><link rel="prefetch" href="/assets/js/225.e8286476.js"><link rel="prefetch" href="/assets/js/226.1a5ed3c4.js"><link rel="prefetch" href="/assets/js/227.1f858ec4.js"><link rel="prefetch" href="/assets/js/228.922400cb.js"><link rel="prefetch" href="/assets/js/229.f4f76eb8.js"><link rel="prefetch" href="/assets/js/23.2ebd6347.js"><link rel="prefetch" href="/assets/js/230.90d1d64e.js"><link rel="prefetch" href="/assets/js/231.39b2f937.js"><link rel="prefetch" href="/assets/js/232.b6a4e1b5.js"><link rel="prefetch" href="/assets/js/233.fb71c41f.js"><link rel="prefetch" href="/assets/js/234.b85ac251.js"><link rel="prefetch" href="/assets/js/235.9943a9b4.js"><link rel="prefetch" href="/assets/js/236.4b0520cf.js"><link rel="prefetch" href="/assets/js/237.01f537cc.js"><link rel="prefetch" href="/assets/js/238.2f2358f0.js"><link rel="prefetch" href="/assets/js/239.c370de0d.js"><link rel="prefetch" href="/assets/js/24.0d68999b.js"><link rel="prefetch" href="/assets/js/240.60feeb13.js"><link rel="prefetch" href="/assets/js/241.28432867.js"><link rel="prefetch" href="/assets/js/242.1109a107.js"><link rel="prefetch" href="/assets/js/243.0df4f268.js"><link rel="prefetch" href="/assets/js/244.b810188e.js"><link rel="prefetch" href="/assets/js/25.c10b4e79.js"><link rel="prefetch" href="/assets/js/26.ec1e370b.js"><link rel="prefetch" href="/assets/js/27.e99f291e.js"><link rel="prefetch" href="/assets/js/28.ca24d672.js"><link rel="prefetch" href="/assets/js/29.470cbccc.js"><link rel="prefetch" href="/assets/js/30.88802dfc.js"><link rel="prefetch" href="/assets/js/31.a03ec43e.js"><link rel="prefetch" href="/assets/js/32.18ba8756.js"><link rel="prefetch" href="/assets/js/33.f757d40f.js"><link rel="prefetch" href="/assets/js/34.1db7326a.js"><link rel="prefetch" href="/assets/js/35.cafda43a.js"><link rel="prefetch" href="/assets/js/36.cd5da123.js"><link rel="prefetch" href="/assets/js/37.a2bda7bd.js"><link rel="prefetch" href="/assets/js/38.98a7b3a5.js"><link rel="prefetch" href="/assets/js/39.aa9264da.js"><link rel="prefetch" href="/assets/js/40.a5d365d8.js"><link rel="prefetch" href="/assets/js/41.24f98119.js"><link rel="prefetch" href="/assets/js/42.871b75aa.js"><link rel="prefetch" href="/assets/js/43.002eb8a7.js"><link rel="prefetch" href="/assets/js/44.73b8112f.js"><link rel="prefetch" href="/assets/js/45.9984b636.js"><link rel="prefetch" href="/assets/js/46.857da14a.js"><link rel="prefetch" href="/assets/js/47.8ae3999c.js"><link rel="prefetch" href="/assets/js/48.b3055c41.js"><link rel="prefetch" href="/assets/js/49.948a556b.js"><link rel="prefetch" href="/assets/js/5.a799d457.js"><link rel="prefetch" href="/assets/js/50.be3dba02.js"><link rel="prefetch" href="/assets/js/51.3efdf52d.js"><link rel="prefetch" href="/assets/js/52.171d8bd9.js"><link rel="prefetch" href="/assets/js/53.54701945.js"><link rel="prefetch" href="/assets/js/54.a5405f79.js"><link rel="prefetch" href="/assets/js/55.0c4314d6.js"><link rel="prefetch" href="/assets/js/56.0ca4cc5e.js"><link rel="prefetch" href="/assets/js/57.565e3bc3.js"><link rel="prefetch" href="/assets/js/58.89763e25.js"><link rel="prefetch" href="/assets/js/59.74b024c8.js"><link rel="prefetch" href="/assets/js/6.1f3a26b9.js"><link rel="prefetch" href="/assets/js/60.f7f49d1f.js"><link rel="prefetch" href="/assets/js/61.25557e44.js"><link rel="prefetch" href="/assets/js/62.1dff34f7.js"><link rel="prefetch" href="/assets/js/63.173d5623.js"><link rel="prefetch" href="/assets/js/64.4971993b.js"><link rel="prefetch" href="/assets/js/65.d3c61fb2.js"><link rel="prefetch" href="/assets/js/66.a290f090.js"><link rel="prefetch" href="/assets/js/67.1f218fc0.js"><link rel="prefetch" href="/assets/js/68.0f2a1ca3.js"><link rel="prefetch" href="/assets/js/69.06f164fc.js"><link rel="prefetch" href="/assets/js/7.104f04e3.js"><link rel="prefetch" href="/assets/js/70.5cc64372.js"><link rel="prefetch" href="/assets/js/71.48b15387.js"><link rel="prefetch" href="/assets/js/72.01503a75.js"><link rel="prefetch" href="/assets/js/73.72356342.js"><link rel="prefetch" href="/assets/js/74.e19df27d.js"><link rel="prefetch" href="/assets/js/75.b2882ed6.js"><link rel="prefetch" href="/assets/js/76.10a097f1.js"><link rel="prefetch" href="/assets/js/77.cd9973e3.js"><link rel="prefetch" href="/assets/js/78.2e4ed47d.js"><link rel="prefetch" href="/assets/js/79.766348b8.js"><link rel="prefetch" href="/assets/js/8.0c893f87.js"><link rel="prefetch" href="/assets/js/80.4f7b6896.js"><link rel="prefetch" href="/assets/js/81.bb4c08c2.js"><link rel="prefetch" href="/assets/js/82.0fd05f6c.js"><link rel="prefetch" href="/assets/js/83.4bf465d6.js"><link rel="prefetch" href="/assets/js/84.f137c5a2.js"><link rel="prefetch" href="/assets/js/85.52ba7737.js"><link rel="prefetch" href="/assets/js/86.3906f3d2.js"><link rel="prefetch" href="/assets/js/87.f804a654.js"><link rel="prefetch" href="/assets/js/88.5779f98c.js"><link rel="prefetch" href="/assets/js/89.8cc396a3.js"><link rel="prefetch" href="/assets/js/90.2db9f434.js"><link rel="prefetch" href="/assets/js/91.86e57b6f.js"><link rel="prefetch" href="/assets/js/92.79a4f213.js"><link rel="prefetch" href="/assets/js/93.bf7cdd19.js"><link rel="prefetch" href="/assets/js/94.f59aa564.js"><link rel="prefetch" href="/assets/js/95.4f792ec4.js"><link rel="prefetch" href="/assets/js/96.72ae7bf4.js"><link rel="prefetch" href="/assets/js/97.4bd0b863.js"><link rel="prefetch" href="/assets/js/98.ec93c96e.js"><link rel="prefetch" href="/assets/js/99.bcc2a378.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.f2bf4038.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b938c1b9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt=" " class="logo"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Documentation</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/UserGuide/Master/QuickStart/QuickStart.html" class="nav-link">latest</a></li><li class="dropdown-item"><!----> <a href="/UserGuide/V0.12.x/QuickStart/QuickStart.html" class="nav-link">v0.12.x</a></li><li class="dropdown-item"><!----> <a href="/UserGuide/V0.11.x/Get Started/QuickStart.html" class="nav-link">v0.11.x</a></li><li class="dropdown-item"><!----> <a href="/UserGuide/V0.10.x/Get Started/QuickStart.html" class="nav-link">v0.10.x</a></li><li class="dropdown-item"><!----> <a href="/UserGuide/V0.9.x/0-Get Started/1-QuickStart.html" class="nav-link">v0.9.x</a></li><li class="dropdown-item"><!----> <a href="/UserGuide/V0.8.x/0-Get Started/1-QuickStart.html" class="nav-link">v0.8.x</a></li></ul></div></div><div class="nav-item"><a href="/SystemDesign/Architecture/Architecture.html" class="nav-link">Design</a></div><div class="nav-item"><a href="/Download/" class="nav-link">Download</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Community</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://cwiki.apache.org/confluence/display/iotdb" class="nav-link external">
  Wiki
  <!----></a></li><li class="dropdown-item"><!----> <a href="/Community/Community-Project Committers.html" class="nav-link">People</a></li><li class="dropdown-item"><!----> <a href="/Community/Community-Powered By.html" class="nav-link">Powered By</a></li><li class="dropdown-item"><!----> <a href="/Community/Materials.html" class="nav-link">Resources</a></li><li class="dropdown-item"><!----> <a href="/Community/Feedback.html" class="nav-link">Feedback</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Development</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Development/VoteRelease.html" class="nav-link">How to vote</a></li><li class="dropdown-item"><!----> <a href="/Development/HowToCommit.html" class="nav-link">How to Commit</a></li><li class="dropdown-item"><!----> <a href="/Development/Committer.html" class="nav-link">Become a Committer</a></li><li class="dropdown-item"><!----> <a href="/Development/ContributeGuide.html" class="nav-link">ContributeGuide</a></li><li class="dropdown-item"><!----> <a href="/Development/format-changelist.html" class="nav-link">Changelist of TsFile</a></li><li class="dropdown-item"><!----> <a href="/Development/rpc-changelist.html" class="nav-link">Changelist of RPC</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">ASF</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://www.apache.org/" class="nav-link external">
  Foundation
  <!----></a></li><li class="dropdown-item"><!----> <a href="http://www.apache.org/licenses/" class="nav-link external">
  License
  <!----></a></li><li class="dropdown-item"><!----> <a href="http://www.apache.org/security/" class="nav-link external">
  Security
  <!----></a></li><li class="dropdown-item"><!----> <a href="http://www.apache.org/foundation/sponsorship.html" class="nav-link external">
  Sponsorship
  <!----></a></li><li class="dropdown-item"><!----> <a href="http://www.apache.org/foundation/thanks.html" class="nav-link external">
  Thanks
  <!----></a></li><li class="dropdown-item"><!----> <a href="http://www.apache.org/events/current-event" class="nav-link external">
  Current Events
  <!----></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/SystemDesign/TsFile/Read.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/zh/SystemDesign/TsFile/Read.html" class="nav-link">简体中文</a></li></ul></div></div> <a href="https://github.com/apache/iotdb.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Documentation</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/UserGuide/Master/QuickStart/QuickStart.html" class="nav-link">latest</a></li><li class="dropdown-item"><!----> <a href="/UserGuide/V0.12.x/QuickStart/QuickStart.html" class="nav-link">v0.12.x</a></li><li class="dropdown-item"><!----> <a href="/UserGuide/V0.11.x/Get Started/QuickStart.html" class="nav-link">v0.11.x</a></li><li class="dropdown-item"><!----> <a href="/UserGuide/V0.10.x/Get Started/QuickStart.html" class="nav-link">v0.10.x</a></li><li class="dropdown-item"><!----> <a href="/UserGuide/V0.9.x/0-Get Started/1-QuickStart.html" class="nav-link">v0.9.x</a></li><li class="dropdown-item"><!----> <a href="/UserGuide/V0.8.x/0-Get Started/1-QuickStart.html" class="nav-link">v0.8.x</a></li></ul></div></div><div class="nav-item"><a href="/SystemDesign/Architecture/Architecture.html" class="nav-link">Design</a></div><div class="nav-item"><a href="/Download/" class="nav-link">Download</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Community</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://cwiki.apache.org/confluence/display/iotdb" class="nav-link external">
  Wiki
  <!----></a></li><li class="dropdown-item"><!----> <a href="/Community/Community-Project Committers.html" class="nav-link">People</a></li><li class="dropdown-item"><!----> <a href="/Community/Community-Powered By.html" class="nav-link">Powered By</a></li><li class="dropdown-item"><!----> <a href="/Community/Materials.html" class="nav-link">Resources</a></li><li class="dropdown-item"><!----> <a href="/Community/Feedback.html" class="nav-link">Feedback</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Development</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Development/VoteRelease.html" class="nav-link">How to vote</a></li><li class="dropdown-item"><!----> <a href="/Development/HowToCommit.html" class="nav-link">How to Commit</a></li><li class="dropdown-item"><!----> <a href="/Development/Committer.html" class="nav-link">Become a Committer</a></li><li class="dropdown-item"><!----> <a href="/Development/ContributeGuide.html" class="nav-link">ContributeGuide</a></li><li class="dropdown-item"><!----> <a href="/Development/format-changelist.html" class="nav-link">Changelist of TsFile</a></li><li class="dropdown-item"><!----> <a href="/Development/rpc-changelist.html" class="nav-link">Changelist of RPC</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">ASF</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://www.apache.org/" class="nav-link external">
  Foundation
  <!----></a></li><li class="dropdown-item"><!----> <a href="http://www.apache.org/licenses/" class="nav-link external">
  License
  <!----></a></li><li class="dropdown-item"><!----> <a href="http://www.apache.org/security/" class="nav-link external">
  Security
  <!----></a></li><li class="dropdown-item"><!----> <a href="http://www.apache.org/foundation/sponsorship.html" class="nav-link external">
  Sponsorship
  <!----></a></li><li class="dropdown-item"><!----> <a href="http://www.apache.org/foundation/thanks.html" class="nav-link external">
  Thanks
  <!----></a></li><li class="dropdown-item"><!----> <a href="http://www.apache.org/events/current-event" class="nav-link external">
  Current Events
  <!----></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/SystemDesign/TsFile/Read.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/zh/SystemDesign/TsFile/Read.html" class="nav-link">简体中文</a></li></ul></div></div> <a href="https://github.com/apache/iotdb.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>System design</span> <!----></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Architecture</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>TsFile</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/SystemDesign/TsFile/TsFile.html" class="sidebar-link">TsFile</a></li><li><a href="/SystemDesign/TsFile/Format.html" class="sidebar-link">Format</a></li><li><a href="/SystemDesign/TsFile/Write.html" class="sidebar-link">Write</a></li><li><a href="/SystemDesign/TsFile/Read.html" aria-current="page" class="active sidebar-link">Read</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>QueryEngine</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SchemaManager</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>StorageEngine</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>DataQuery</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Tools</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Connector</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Client</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="content content__default"><h1 id="tsfile-reading-process"><a href="#tsfile-reading-process" class="header-anchor">#</a> TsFile Reading Process</h1> <p>This chapter introduces how to read TsFile. The content is mainly divided into two parts, the introduction of Filters and Expressions , and the detailed illustration of query process in TsFile.</p> <ul><li><a href="#TsFile-Read-Process">TsFile Read Process</a> <ul><li><a href="#1-Filters-and-Expressions">1 Filters and Expressions</a> <ul><li><a href="#11-Filter">1.1 Filter</a></li> <li><a href="#12-Expression">1.2 Expression</a> <ul><li><a href="#121-SingleSeriesExpression">1.2.1 SingleSeriesExpression</a></li> <li><a href="#122-GlobalTimeExpression">1.2.2 GlobalTimeExpression</a></li> <li><a href="#123-IExpression">1.2.3 IExpression</a></li> <li><a href="#124-Executable-Expression">1.2.4 Executable Expression</a></li> <li><a href="#125-The-Algorithm-Transforming-IExpression-to-an-Executable-Expression">1.2.5 The Algorithm Transforming IExpression to an Executable Expression</a></li></ul></li></ul></li> <li><a href="#2-Query-Execution-of-TsFile">2 Query Execution of TsFile</a> <ul><li><a href="#21-Design">2.1 Design</a></li> <li><a href="#22-Three-Components">2.2 Three Components</a> <ul><li><a href="#221-FileSeriesReader">2.2.1 FileSeriesReader</a></li> <li><a href="#222-FileSeriesReaderByTimestamp">2.2.2 FileSeriesReaderByTimestamp</a></li> <li><a href="#223-TimeGeneratorImpl">2.2.3 TimeGeneratorImpl</a></li></ul></li> <li><a href="#23-Merge-Query">2.3 Merge Query</a></li> <li><a href="#24-Join-Query">2.4 Join Query</a></li> <li><a href="#25-Query-of-TsFile">2.5 Query of TsFile</a></li> <li><a href="#26-Related-Concepts">2.6 Related Concepts</a></li></ul></li></ul></li></ul> <h2 id="_1-filters-conditions-and-query-experssions"><a href="#_1-filters-conditions-and-query-experssions" class="header-anchor">#</a> 1 Filters conditions and query experssions</h2> <h3 id="_1-1-filter"><a href="#_1-1-filter" class="header-anchor">#</a> 1.1 Filter</h3> <p>This chapter introduces the filtering conditions and the relevant defination of query expression when TSFILE file is read first. Secondly, how to transform the filtering conditions entered by users into query conditions that the system can execute.</p> <p>Filter represents the basic filtering condition. The user can specify specific filtering criteria on a timestamp or on a column of values. After distinguishing the filtering conditions of timestamp and column value, let t represent a certain timestamp constant. Filter has the following 12 basic types, which are inheritance relations in implementation.</p> <table><thead><tr><th>Filter</th> <th>Filter Type</th> <th>Explanation</th> <th>Examples</th></tr></thead> <tbody><tr><td>TimeEq</td> <td>time filter</td> <td>timestamp = some value</td> <td>TimeEq(t) means timestamp should be equal to t</td></tr> <tr><td>TimeGt</td> <td>time filter</td> <td>timestamp &gt; some value</td> <td>TimeGt(t) means timestamp should be greater than t</td></tr> <tr><td>TimeGtEq</td> <td>time filter</td> <td>timestamp &gt;= some value</td> <td>TimeGtEq(t) means timestamp greater than or equal to t</td></tr> <tr><td>TimeLt</td> <td>time filter</td> <td>timestamp &lt; some value</td> <td>TimeLt(t) means timestamp should be less than t</td></tr> <tr><td>TimeLtEq</td> <td>time filter</td> <td>timestamp &lt;= some value</td> <td>TimeLtEq(t) means timestamp should be less than or equal to t</td></tr> <tr><td>TimeNotEq</td> <td>time filter</td> <td>timestamp != some value</td> <td>TimeNotEq(t) means timestamp should not be equal to t</td></tr> <tr><td>ValueEq</td> <td>value filter</td> <td>value on this column = some value</td> <td>ValueEq(2147483649) means value on this column should be equal to 2147483649</td></tr> <tr><td>ValueGt</td> <td>value filter</td> <td>value on this column &gt; some value</td> <td>ValueGt(100.5) means value on this column should be greater than 100.5</td></tr> <tr><td>ValueGtEq</td> <td>value filter</td> <td>value on this column &gt;= some value</td> <td>ValueGtEq(2) means value on this column should be greanter than 2</td></tr> <tr><td>ValueLt</td> <td>value filter</td> <td>value on this column &lt; some value</td> <td>ValueLt(&quot;string&quot;) means value on this column should be less than &quot;string&quot; in alphabet order</td></tr> <tr><td>ValueLtEq</td> <td>value filter</td> <td>value on this column &lt;= some value</td> <td>ValueLtEq(-100) means value on this column shold be less than or equal to -100</td></tr> <tr><td>ValueNotEq</td> <td>value filter</td> <td>value on this column != some value</td> <td>ValueNotEq(true) means value on this column should not be true</td></tr></tbody></table> <p>A filter can consist of one or two sub-filters.。If a Filter is composed of a single Filter, it is also termed as UnaryFilter.If it contains two filters, it is termed as BinaryFilter. In this case, the two filters are connected with a logical relation, AND or OR, where the formar is termed as AndFilter, and the latter is OrFilter. Obviously, both AndFilter and OrFilter are BinaryFilter.</p> <p>We give some examples of AndFilter and OrFilter, where &quot;&amp;&amp;&quot; indicates relation AND and &quot;||&quot; indicates relation OR.</p> <ol><li>AndFilter(TimeGt(100), TimeLt(200)) means &quot;timestamp &gt; 100 &amp;&amp; timestamp &lt; 200&quot;</li> <li>AndFilter (TimeGt(100), ValueGt(0.5)) means &quot;timestamp &gt; 100 &amp;&amp; value &gt; 0.5&quot;</li> <li>AndFilter (AndFilter (TimeGt(100), TimeLt(200)), ValueGt(0.5)) means &quot;(timestamp &gt; 100 &amp;&amp; timestamp &lt; 200) &amp;&amp; value &gt; 0.5&quot;</li> <li>OrFilter(TimeGt(100), ValueGt(0.5)) means &quot;timestamp &gt; 100 || value &gt; 0.5&quot;</li> <li>OrFilter (AndFilter(TimeGt(100), TimeLt(200)), ValueGt(0.5)) means &quot;(timestamp &gt; 100 &amp;&amp; timestamp &lt; 200) || value &gt; 0.5&quot;</li></ol> <p>The formal definition of &quot;Filter&quot;, &quot;AndFilter&quot; and &quot;OrFilter&quot; are shown below:</p> <div class="language- extra-class"><pre><code>Filter := Basic Filter | AndFilter | OrFilter
AndFilter := Filter &amp;&amp; Filter
OrFilter := Filter &amp;&amp; Filter
</code></pre></div><p>For simplicity, we symbolize Basic Filter, AndFilter and OrFilter. Note that t is a variable of type INT64, v is a variable whose type can be BOOLEAN, INT32, INT64, FLOAT, DOUBLE or BINARY。</p> <table><thead><tr><th>Name</th> <th>symbol</th> <th>Examples</th></tr></thead> <tbody><tr><td>TimeEq</td> <td>time == t</td> <td>time == 14152176545 means timestamp should be equal to 14152176545</td></tr> <tr><td>TimeGt</td> <td>time &gt; t</td> <td>time &gt; 14152176545 means timestamp should be greater than 14152176545</td></tr> <tr><td>TimeGtEq</td> <td>time &gt;= t</td> <td>time &gt;= 14152176545 means timestamp should be greater than or equal to 14152176545</td></tr> <tr><td>TimeLt</td> <td>time &lt; t</td> <td>time &lt; 14152176545 means timestamp should be less than 14152176545</td></tr> <tr><td>TimeLtEq</td> <td>time &lt;= t</td> <td>time &lt;= 14152176545 means timestamp should be less than or equal to 14152176545</td></tr> <tr><td>TimeNotEq</td> <td>time != t</td> <td>time != 14152176545 means timestamp</td></tr></tbody></table> <p>should be equal to 14152176545
ValueEq| value == v| value == 10 means value should be equal to 10
ValueGt| value &gt; v| value &gt; 100.5 means value should be greater than 100.5
ValueGtEq| value &gt;= v| value &gt;= 2 means value should be greater than or equal to 2
ValueLt| value &lt; v| value &lt; &quot;string&quot; means value should be less than &quot;string&quot; in alphabet order
ValueLtEq| value &lt;= v| value &lt;= -100 means value should be less than or equal to -100
ValueNotEq| value != v| value != true means value should not be true
AndFilter| &lt;Filter&gt; &amp;&amp; &lt;Filter&gt;| 1. value &gt; 100 &amp;&amp; value &lt; 200 means value should be greanter than 100 and less than 200; <br>2. (value &gt;= 100 &amp;&amp; value &lt;= 200) &amp;&amp; time &gt; 14152176545 means &quot;value should be greater than or equal to 100 and value should be less than or equal to&quot; and &quot;timestamp should be greater than 14152176545&quot;
OrFilter| &lt;Filter&gt; || &lt;Filter&gt;| 1. value &gt; 100 || time &gt;  14152176545, means value should be greater than 100 or timestamp should be greater than 14152176545;<br>2. (value &gt; 100 &amp;&amp; value &lt; 200)|| time &gt; 14152176545, means &quot;value should be greater than 100 and value should be less than 200&quot; or &quot;timestamp should be greater than 14152176545&quot;</p> <h3 id="_1-2-expression"><a href="#_1-2-expression" class="header-anchor">#</a> 1.2 Expression</h3> <p>When we assign a particular time series (including the timestamp) to a Filter, it becomes an expression. For example, &quot;value &gt; 10&quot; can only describe a Filter, without the taste of a query. However, &quot;the value of time series 'd1.s1' should be greater than 10&quot; is an expression. Specifically, if the Filter only works on timestamp, it can be seen as an expression, which is called GlobalTimeExpression. The following sections introduces Expression in detail,</p> <h4 id="_1-2-1-singleseriesexpression"><a href="#_1-2-1-singleseriesexpression" class="header-anchor">#</a> 1.2.1 SingleSeriesExpression</h4> <p>SingleSeriesExpression is an expression on a time series (excluding the timestamp column) with a Filter. A SingleSeriesExpression contains a Path and a Filter. The Path is the path of the time series, and the Filter indicate the filter condition, as is introduced in section 1.1.</p> <p>The structure of SingleSeriesExpression is shown below:</p> <div class="language- extra-class"><pre><code>SingleSeriesExpression
    Path: the path of the time series in the given SingleSeriesExpression
    Filter: filter condition
</code></pre></div><p>When querying, a SingleSeriesExpression claims that the data point in the time series should satisfy the constraints in the Filter.</p> <p>Examples of SingleSeriesExpression are shown below.</p> <p>Example 1.</p> <div class="language- extra-class"><pre><code>SingleSeriesExpression
    Path: &quot;d1.s1&quot;
    Filter: AndFilter(ValueGt(100), ValueLt(200))
</code></pre></div><p>The SingleSeriesExpression claims that time series &quot;d1.s1&quot; should satisfy that &quot;value should be greater than 100 and less than 200&quot;。</p> <p>We formalize the rule as SingleSeriesExpression(&quot;d1.s1&quot;, value &gt; 100 &amp;&amp; value &lt; 200)</p> <hr> <p>Example 2.</p> <div class="language- extra-class"><pre><code>SingleSeriesExpression
    Path: &quot;d1.s1&quot;
    Filter: AndFilter(AndFilter(ValueGt(100), ValueLt(200)), TimeGt(14152176545))
</code></pre></div><p>The SingleSeriesExpression claims that time series &quot;d1.s1&quot; should satisfy that &quot;value should be greater than 100 and less than 200 and timestamp should be greater than 14152176545&quot;。</p> <p>We formalize the rule as SingleSeriesExpression(&quot;d1.s1&quot;, (value &gt; 100 &amp;&amp; value &lt; 200) &amp;&amp; time &gt; 14152176545)</p> <h4 id="_1-2-2-globaltimeexpression"><a href="#_1-2-2-globaltimeexpression" class="header-anchor">#</a> 1.2.2 GlobalTimeExpression</h4> <p>GlobalTimeExpression means a global time filter. A GlobalTimeExpression contains a Filter, which is only composed of time filters (value filters not allowed). When querying, a GlobalTimeExpression claims that data points of all selected time series should satisfy the constraints in the Filter. The structure of GlobalTimeExpression is shown below:</p> <div class="language- extra-class"><pre><code>GlobalTimeExpression
    Filter: a filter which only contains time filters。
    The formalized definition of Filter here is: 
        Filter := TimeFilter | AndExpression | OrExpression
        AndExpression := Filter &amp;&amp; Filter
        OrExpression := Filter &amp;&amp; Filter
</code></pre></div><p>Some formalized examples of GlobalTimeExpression are shown below:</p> <ol><li>GlobalTimeExpression(time &gt; 14152176545 &amp;&amp; time &lt; 14152176645) claims that the all selected time series should satisfy that the timestamp should be &quot;greater than 14152176545 and less than 14152176645&quot;</li> <li>GlobalTimeExpression((time &gt; 100 &amp;&amp; time &lt; 200) || (time &gt; 400 &amp;&amp; time &lt; 500)) claims that all selected time series should satisfy that the timestamp should be &quot;greater than 100 and less than 200&quot; or &quot;greater than 400 and less than 500&quot;</li></ol> <h4 id="_1-2-3-iexpression"><a href="#_1-2-3-iexpression" class="header-anchor">#</a> 1.2.3 IExpression</h4> <p>IExpression indicates the all filters with the corresponding columns in a query.
An IExpression can be a SingleSeriesExpression or a GlobalTimeExpression. In this case, the IExpression is a UnaryExpression. An IExpression can also contains two IExpressions, connected with relation AND or OR. Two IExpressions joined with AND relation is termed as AndExpression. Likewise, two IExpressions joined with OR relation is termed as OrExpression. An IExpression containing two children is termed BinaryExpression. UnaryExpression and BinaryExpression are both IExpression.</p> <p>The formalized definition of IExpression is shown below:</p> <div class="language- extra-class"><pre><code>IExpression := SingleSeriesExpression | GlobalTimeExpression | AndExpression | OrExpression
AndExpression := IExpression &amp;&amp; IExpression
OrExpression := IExpression || IExpression
</code></pre></div><p>We use a tree-like structure to formalize an IExpression. Here are some examples.</p> <ol><li><p>An IExpression only contains a SingleSeriesExpression:</p> <div class="language- extra-class"><pre><code> IExpression(SingleSeriesExpression(&quot;d1.s1&quot;, value &gt; 100 &amp;&amp; value &lt; 200))
</code></pre></div></li> <li><p>An IExpression only contains a GlobalTimeExpression:</p> <div class="language- extra-class"><pre><code> IExpression(GlobalTimeExpression (time &gt; 14152176545 &amp;&amp; time &lt; 14152176645))
</code></pre></div></li> <li><p>An IExpression contains multiple SingleSeriesExpressions:</p> <div class="language- extra-class"><pre><code> IExpression(
     AndExpression
         SingleSeriesExpression(&quot;d1.s1&quot;, (value &gt; 100 &amp;&amp; value &lt; 200) || time &gt; 14152176645)
         SingleSeriesExpression(&quot;d1.s2&quot;, value &gt; 0.5 &amp;&amp; value &lt; 1.5)
 )
</code></pre></div><p><strong>Note</strong>: The IExpression is an AndExpression, where the time series &quot;d1.s1&quot; and &quot;d1.s2&quot; should satisfy the constraints in the Filter.</p></li> <li><p>An IExpression contains both SingleSeriesExpressions and GlobalTimeExpressions</p> <div class="language- extra-class"><pre><code> IExpression(
     AndExpression
         AndExpression
             SingleSeriesExpression(&quot;d1.s1&quot;, (value &gt; 100 &amp;&amp; value &lt; 200) || time &gt; 14152176645)
             SingleSeriesExpression(&quot;d1.s2&quot;, value &gt; 0.5 &amp;&amp; value &lt; 1.5)
         GlobalTimeExpression(time &gt; 14152176545 &amp;&amp; time &lt; 14152176645)
 )
</code></pre></div><p><strong>Note</strong>: The IExpression is an AndExpression, where the time series &quot;d1.s1&quot; and &quot;d1.s2&quot; should not only satisfy the constraints in corresponding Filters in SingleSeriesExpression, but also the constraints of the GlobalTimeExpression.</p></li></ol> <h4 id="_1-2-4-executable-expression"><a href="#_1-2-4-executable-expression" class="header-anchor">#</a> 1.2.4 Executable Expression</h4> <p>To make the query execution more comprehensible, we give the concept of executable expression. An executable expression is a particular kinds of IExpression. The IExpression customized by system user can be transformed to an executable expression by some algorithm, which will be introduced in the following sections. An executable expression is an IExpression satisfying one of the following constraints:</p> <ol><li>The IExpression is a single GlobalTimeExpression</li> <li>The IExpression is a single SingleSeriesExpression</li> <li>The IExpression is an AndExpression, whose leaf nodes are SingleSeriesExpressions</li> <li>The IExpression is an OrExpression, whose leaf nodes are SingleSeriesExpressions</li></ol> <p>The formalized definition of an executable expression is shown below:</p> <div class="language- extra-class"><pre><code>executable expression := SingleSeriesExpression| GlobalTimeExpression | AndExpression | OrExpression
AndExpression := &lt; ExpressionUNIT &gt; &amp;&amp; &lt; ExpressionUNIT &gt;
OrExpression := &lt; ExpressionUNIT &gt; || &lt; ExpressionUNIT &gt;
ExpressionUNIT := SingleSeriesExpression | AndExpression | OrExpression
</code></pre></div><p>Some examples of executable expression and non-executable expression are show below:</p> <p>Example 1:</p> <div class="language- extra-class"><pre><code>IExpression(SingleSeriesExpression(&quot;d1.s1&quot;, value &gt; 100 &amp;&amp; value &lt; 200))
</code></pre></div><p>Is an executable expression? Yes</p> <p><strong>Hint</strong>: The IExpression is a single SingleSeriesExpression, satisfying constraint 1</p> <hr> <p>Example 2:</p> <div class="language- extra-class"><pre><code>IExpression(GlobalTimeExpression (time &gt; 14152176545 &amp;&amp; time &lt; 14152176645))
</code></pre></div><p>Is an executable expression? Yes</p> <p><strong>Hint</strong>: The IExpression is a single GlobalTimeExpression, satisfying constraint 2</p> <hr> <p>Example 3:</p> <div class="language- extra-class"><pre><code>IExpression(
    AndExpression
        GlobalTimeExpression (time &gt; 14152176545)
        GlobalTimeExpression (time &lt; 14152176645)
)
</code></pre></div><p>Is an executable expression? No</p> <p><strong>Hint</strong>: The IExpression is an AndExpression, but it contains GlobalTimeExpressions, which is against constraint 3</p> <hr> <p>Example 4:</p> <div class="language- extra-class"><pre><code>IExpression(
    OrExpression
        AndExpression
            SingleSeriesExpression(&quot;d1.s1&quot;, (value &gt; 100 &amp;&amp; value &lt; 200) || time &gt; 14152176645)
            SingleSeriesExpression(&quot;d1.s2&quot;, value &gt; 0.5 &amp;&amp; value &lt; 1.5)
    SingleSeriesExpression(&quot;d1.s3&quot;, value &gt; &quot;test&quot; &amp;&amp; value &lt; &quot;test100&quot;)
)
</code></pre></div><p>Is an executable expression? Yes</p> <p><strong>Hint</strong>: The IExpression is an OrExpression, whose leaf nodes are all SingleSeriesExpressions, which satisfies constraints 4.</p> <hr> <p>Example 5:</p> <div class="language- extra-class"><pre><code>IExpression(
    AndExpression        
        AndExpression
            SingleSeriesExpression(&quot;d1.s1&quot;, (value &gt; 100 &amp;&amp; value &lt; 200) || time &gt; 14152176645)
            SingleSeriesExpression(&quot;d1.s2&quot;, value &gt; 0.5 &amp;&amp; value &lt; 1.5)
        GlobalTimeExpression(time &gt; 14152176545 &amp;&amp; time &lt; 14152176645)
)
</code></pre></div><p>Is an executable expression? No</p> <p><strong>Hint</strong>: The IExpression is an AndExpression, but one of the leaf nodes is a GlobalTimeExpression, which is against constraint 3.</p> <h4 id="_1-2-5-the-algorithm-transforming-iexpression-to-an-executable-expression"><a href="#_1-2-5-the-algorithm-transforming-iexpression-to-an-executable-expression" class="header-anchor">#</a> 1.2.5 The Algorithm Transforming IExpression to an Executable Expression</h4> <p>In this section, we introduce how to transform an IExpression to be executable.</p> <p>If an IExpression is not executable, it is either an AndExpression, or an OrExpression. Moreover, it contains both GlobalTimeExpressions and SingleSeriesExpressions. According to the definition in the preceding sections, an AndExpression or OrExpression is composed of two IExpressions, that</p> <div class="language- extra-class"><pre><code>AndExpression := &lt;IExpression&gt; AND &lt;IExpression&gt;
OrExpression := &lt;IExpression&gt; OR &lt;IExpression&gt;
</code></pre></div><p>We denote the left child and right child as LeftIExpression and RightIExpression, so that</p> <div class="language- extra-class"><pre><code>AndExpression := &lt;LeftIExpression&gt; AND &lt;RightIExpression&gt;
OrExpression := &lt;LeftIExpression&gt; OR &lt;RightIExpression&gt;
</code></pre></div><p>The declaration of the method is shown below.</p> <div class="language- extra-class"><pre><code>IExpression optimize (IExpression expression, List&lt;Path&gt; selectedSeries)

Input: The IExpression to be transformed, and the projected time series
Output: The transformed IExpression, which is executable
</code></pre></div><p>Before the introducing the optimize() method in detail, we first show how to combine two expressions or filters, which is very useful in the optimize() method.</p> <ul><li><p>combineTwoGlobalTimeExpression combines two GlobalTimeExpressions to be a single GlobalTimeExpression。</p> <p>This method receives three inputs. The declaration of the method is:</p> <div class="language- extra-class"><pre><code>  GlobalTimeExpression combineTwoGlobalTimeExpression(
      GlobalTimeExpression leftGlobalTimeExpression,
      GlobalTimeExpression rightGlobalTimeExpression,
      ExpressionType type)

  Input 1: leftGlobalTimeExpression
  Input 2: rightGlobalTimeExpression
  Input 3: type, the relation of the two expressions, which is either &quot;AND&quot; or &quot;OR&quot;

  Output: GlobalTimeExpression, which is the merged expression
</code></pre></div><p>The method contains two steps:</p> <ol><li>Denote the Filter in leftGlobalTimeExpression as filter1, in rightGlobalTimeExpression as filter2. It first merges filter1 and filter2 to be a new Filter, denoted as filter3. The method of merging two filters is shown in MergeFilter in the following section.</li> <li>Generate a new GlobalTimeExpression, and assign filter3 to be its Filter. This new GlobalTimeExpression is the result.</li></ol> <p>An example of combining two GlobalTimeExpressions is shown below.</p> <p>The three inputs are:</p> <div class="language- extra-class"><pre><code>  leftGlobalTimeExpression: GlobalTimeExpression(Filter: time &gt; 100 &amp;&amp; time &lt; 200)
  rightGlobalTimeExpression: GlobalTimeExpression(Filter: time &gt; 300 &amp;&amp; time &lt; 400)
  type: OR
</code></pre></div><p>than, the merged expression is</p> <div class="language- extra-class"><pre><code>  GlobalTimeExpression(Filter: (time &gt; 100 &amp;&amp; time &lt; 200) || (time &gt; 300 &amp;&amp; time &lt; 400))
</code></pre></div></li> <li><p>MergeFilter merges two Filters. This method receives three inputs:</p> <div class="language- extra-class"><pre><code>  Filter1: The first Filter to merge
  Filter2: The second Filter to merge
  Relation: The relation between the two Filters (either AND or OR)
</code></pre></div><p>than, the execution strategy of this method is</p> <div class="language- extra-class"><pre><code>  if relation == AND:
      return AndFilter(Filter1, Filter2)
  else if relation == OR:
      return OrFilter(Filter1, Filter2)
</code></pre></div><p>This method is implemented in <code>AndFilter and(Filter left, Filter right)</code> and <code>OrFilter or(Filter left, Filter right)</code> in class FilterFactory.</p></li> <li><p>handleOneGlobalExpression merges a GlobalTimeExpression and an IExpression to be one executable expression. The result of the method only contains SingleSeriesExpressions. The declaration of the function is shown below:</p> <div class="language- extra-class"><pre><code>  IExpression handleOneGlobalTimeExpression(
      GlobalTimeExpression globalTimeExpression,
      IExpression expression,
      List&lt;Path&gt; selectedSeries, 
      ExpressionType relation)

  Input 1: GlobalTimeExpression
  Input 2: IExpression
  Input 3: time series to project
  Input 4: the relation between the two expressions (either AND or OR)

  Output: an IExpression which is executable
</code></pre></div><p>This method first calls optimize() to transform the second input IExpression to be executable, which is recursive in view of optimize(), and then combine them in two ways.</p> <p><em>Case 1</em>: The relation between GlobalTimeExpression and the optimized IExpression is AND. In this case, denote the Filter in GlobalTimeExpression as Filter. We just need to merge the tFilter to the Filters of each SingleSeriesExpression in the IExpression。This method is implemented in <code>void addTimeFilterToQueryFilter(Filter timeFilter, IExpression expression)</code>. Here is an example:</p> <p>To combine the following GlobaLTimeFilter and IExpression where</p> <div class="language- extra-class"><pre><code>  1. GlobaLTimeFilter(tFilter)
  2. IExpression
          AndExpression
              OrExpression
                  SingleSeriesExpression(&quot;path1&quot;, filter1)
                  SingleSeriesExpression(&quot;path2&quot;, filter2)
              SingleSeriesExpression(&quot;path3&quot;, filter3)
</code></pre></div><p>The result is</p> <div class="language- extra-class"><pre><code>  IExpression
      AndExpression
          OrExpression
              SingleSeriesExpression(&quot;path1&quot;, AndFilter(filter1, tFilter))
              SingleSeriesExpression(&quot;path2&quot;, AndFilter(filter2, tFilter))
          SingleSeriesExpression(&quot;path3&quot;, AndFilter(filter3, tFilter))
</code></pre></div><p><em>Case 2</em>: The relation between GlobalTimeExpression and IExpression is OR. In this case, the merge steps include:</p> <ol><li>Analyse the projected time series, which is a set of Path. To take a query with 3 projected time series as an example, denote that projected time series as a set, PathList{path1, path2, path3}。</li> <li>Denote the Filter in GlobalTimeExpression to be tFilter. The method calls pushGlobalTimeFilterToAllSeries() to generate a corresponding SingleSeriesExpression for each Path. Set the Filters of SingleSeriesExpressions to be tFilter. Join the generated SingleSeriesExpression with OR operator to get an OrExpression, which is denoted as orExpression.</li> <li>Call mergeSecondTreeToFirstTree method to combine the nodes in IExpression with the nodes in the orExpression, which is generated from step 2. The combined structure is the result expression.</li></ol> <p>For example, to combine the following GlobalTimeFilter and IExpression using OR relation, denote the projected time series as PathList{path1, path2, path3}</p> <div class="language- extra-class"><pre><code>  1. GlobalTimeFilter(tFilter)
  2. IExpression
          AndExpression
              SingleSeriesExpression(&quot;path1&quot;, filter1)
              SingleSeriesExpression(&quot;path2&quot;, filter2)
</code></pre></div><p>the result is</p> <div class="language- extra-class"><pre><code>  IExpression
      OrExpression
          AndExpression
              SingleSeriesExpression(&quot;path1&quot;, filter1)
              SingleSeriesExpression(&quot;path2&quot;, filter2)
          OrExpression
              OrExpression
                  SingleSeriesExpression(&quot;path1&quot;, tFilter)
                  SingleSeriesExpression(&quot;path2&quot;, tFilter)
              SingleSeriesExpression(&quot;path3&quot;, tFilter)
</code></pre></div></li> <li><p>MergeIExpression combines two IExpressions to be one executable expression. This method receives three inputs, respectively</p> <div class="language- extra-class"><pre><code>  IExpression1: the first IExpression to merge
  IExpression2: the second IExpression to merge
  relation: the relation between the two IExpressions (AND or OR)
</code></pre></div><p>The strategy of the method is:</p> <div class="language- extra-class"><pre><code>  if relation == AND:
      return AndExpression(IExpression1, IExpression2)
  else if relation == OR:
      return OrExpression(IExpression1, IExpression2)
</code></pre></div></li></ul> <p>Using the above four combination methods, the steps of optimize() include:</p> <ol><li><p>If the IExpression is a UnaryExpression, (a single SingleSeriesExpression or GlobalTimeExpression), return the IExpression without any operations. Otherwise, go to step 2.</p></li> <li><p>When it reaches this step, it means that the IExpression is an AndExpression or OrExpression.</p> <p>a. If the LeftIExpression and RightIExpression both are GlobalTimeExpression, use combineTwoGlobalTimeExpression method, and output the result.</p> <p>b. If LeftIExpression is a GlobalTimeExpression, and RightIExpression is not a GlobalTimeExpression, call handleOneGlobalExpression() to combine them。</p> <p>c. If LeftIExpression is not a GlobalTimeExpression, while RightIExpression is, call handleOneGlobalExpression() to combine them.</p> <p>d. If neither LeftIExpression nor RightIExpression is a GlobalTimeExpression, recursively call optimize() method on both LeftIExpression  and RightIExpression to get the left executable expression and the right executable expression. Then use mergeIExpression method to generate a final IExpression which is executable.</p></li></ol> <h2 id="_2-query-execution-of-tsfile"><a href="#_2-query-execution-of-tsfile" class="header-anchor">#</a> 2 Query Execution of TsFile</h2> <h3 id="_2-1-design"><a href="#_2-1-design" class="header-anchor">#</a> 2.1 Design</h3> <p>The interface of TsFile on file level is intended only for queries on original data. According to the existence of value filter, the query can be divided into two groups: those without filters or only with a time filter, and those containing value filters.</p> <p>To execute the two kinds of queries, we design two query execution methods:</p> <ul><li><p>merge query</p> <p>It generates multiple readers, aligns the result in time, and returns the result set.</p></li> <li><p>join query</p> <p>According to the query conditions, it generates satisfying timestamp, which is used for generating result set.</p></li></ul> <h3 id="_2-2-three-components"><a href="#_2-2-three-components" class="header-anchor">#</a> 2.2 Three Components</h3> <h4 id="_2-2-1-fileseriesreader"><a href="#_2-2-1-fileseriesreader" class="header-anchor">#</a> 2.2.1 FileSeriesReader</h4> <p>org.apache.iotdb.tsfile.read.reader.series.FileSeriesReader</p> <p><strong>Functions</strong>: FileSeriesReader queries the data points of a time series in a file, which satisfies the filter conditions. It outputs the data points of the given time series in the given file in timestamp ascending order. There can be no filters at all.</p> <p><strong>Implementation</strong>: FileSeriesReader retrieves the Chunk information of the given time series according to the Path, it then traverses each Chunk in timestamp ascending order, and outputs the satisfying data points.</p> <h4 id="_2-2-2-fileseriesreaderbytimestamp"><a href="#_2-2-2-fileseriesreaderbytimestamp" class="header-anchor">#</a> 2.2.2 FileSeriesReaderByTimestamp</h4> <p>org.apache.iotdb.tsfile.read.reader.series.FileSeriesReaderByTimestamp</p> <p><strong>Functions</strong>: FileSeriesReaderByTimestamp queries the data points of a time series in a file, whose timestamp satisfies the timestamp constraints.</p> <p><strong>Implementation</strong>: This component provides an interface, getValueInTimestamp(long timestamp), which receives increasing timestamp value,  and outputs the data points on the time series whose timestamp is identical. If there's no such data point, the result is null.</p> <h4 id="_2-2-3-tsfiletimegenerator"><a href="#_2-2-3-tsfiletimegenerator" class="header-anchor">#</a> 2.2.3 TsFileTimeGenerator</h4> <p>org.apache.iotdb.tsfile.read.query.timegenerator.TsFileTimeGenerator</p> <p><strong>Functions</strong>: According to the filter condition, TimeGeneratorImpl generates the satisfying timestamp. It first transforms the filter conditions to be a binary tree, and recursively generate the satisfying timestamp. This component is used in executing join query.</p> <p>An executable expression contains one or nultiple SingleSeriesExpressions. The relation between two SingleSeriesExpressions is either AND or OR. Therefore, the filter in an executable expression can be transformed to a binary tree, where the leaf nodes are FileSeriesReader, and the non-leaf nodes are AndNode or OrNode. Particularly, when the expression only contains a single SingleSeriesExpression, the binary tree only has one node. The satisfying timestamp can be generated using the binary tree.</p> <p>This component provides two basic functions:</p> <ol><li><p>check if there exists a next satisfying timestamp</p></li> <li><p>get the next satisfying timestamp</p></li></ol> <h3 id="_2-3-query-merging"><a href="#_2-3-query-merging" class="header-anchor">#</a> 2.3 Query Merging</h3> <p>org.apache.iotdb.tsfile.read.query.dataset.DataSetWithoutTimeGenerator</p> <p>Suppose there are n time series. For each one of them, a FileSeriesReader will be generated. If there's a GlobalTimeExpression, the filter in it will be input to the FileSeriesReaders.</p> <p>A DataSetWithoutTimeGenerator will be generated using these FileSeriesReaders. Since each FileSeriesReader outputs data points in time stamp ascending order, we can use the idea of k-way merge to align the result data points.</p> <p>The steps include:</p> <p>(1) Create a min-heap, which stores timestamps. The min-heap is organized according to the value of the timestamp.</p> <p>(2) Initialize the min-heap. Access each FileSeriesReader once. If there's a next data point in the FileSeriesReader, add its timestamp to the min-heap. Till now, the heap contains at most one timestamp of each time series, which is the minimum in its corresponding time series.</p> <p>(3) If the size of the heap is greater than 0, take the timestamp on the top of the heap, denote it as t, and remove it from the heap, then go to step (4). If the number of the heap is 0, go to step (5).</p> <p>(4) Create a new RowRecord. In turns access each time series. When dealing with a time series, first check if there's a next data point, if it fails, set the result data point to be null. Otherwise, check if minimum timestamp in the time series is identical to t. If it is not, set the result data point to be null. Otherwise, get the data point and set it to be the result data point. If there exists a next data point after that. If it has, then set timestamp of the next data point in the time series to be its minimum timestamp. After accessing all time series, combine the result data points to form a RowRecord. Finally, go to step (3).</p> <p>(5) Terminate the process.</p> <h3 id="_2-4-join-queries"><a href="#_2-4-join-queries" class="header-anchor">#</a> 2.4 Join Queries</h3> <p>org.apache.iotdb.tsfile.read.query.executor.ExecutorWithTimeGenerator</p> <p>Join query execution generates timestamp according to the filter conditions, and retrieves the data point on the projected time series to form a RowRecord. Main steps include;</p> <p>(1) According to QueryExpression, initialize the timestamp generation module, TimeGeneratorImpl</p> <p>(2) Generate FileSeriesReaderByTimestamp for each projected time series.</p> <p>(3) If there exists a next timestamp in the &quot;timestamp generation module&quot;, denote the timestamp t, go to step (4).Otherwise, terminate the query execution.</p> <p>(4) According to t, utilize FileSeriesReaderByTimestamp on each time series to retrieve the data point whose corresponding timestamp is t. If there's no such data point, use null to represent it.</p> <p>(5) Combine the data points in step (4) to form a RowRecord, then go to step (3) to generate another row of records.</p> <h3 id="_2-5-query-entrence-of-tsfile"><a href="#_2-5-query-entrence-of-tsfile" class="header-anchor">#</a> 2.5 Query entrence of TsFile</h3> <p>org.apache.iotdb.tsfile.read.query.executor.TsFileExecutor</p> <p>TsFileExecutor receives a QueryExpression, execute the query and outputs the QueryDataSet。The work flow includes the following steps:</p> <p>(1) Receive a QueryExpression.</p> <p>(2) If the QueryExpression contains no filter conditions, execute merge query. If it contains any Filters, use ExpressionOptimizer to optimize the IExpression in QueryExpression. If the optimized IExpression is a GlobalTimeExpression, execute merge query. If it contains value filters, it sends a message to ExecutorWithTimeGenerator to execute join query.</p> <p>(3) Generate the QueryDataSet. It iteratively generates RowRecord and returns the results.</p> <h3 id="_2-6-related-concepts"><a href="#_2-6-related-concepts" class="header-anchor">#</a> 2.6 Related Concepts</h3> <ul><li><p>Chunk: Chunk is the storage structure of a chunk of time series. IChunkReader is for reading the content。</p></li> <li><p>ChunkMetaData: ChunkMetaData records the offset, data type and encoding info of the Chunk in the File.</p></li> <li><p>IMetadataQuerier: IMetadataQuerier is a querier for TsFile metadata. It queries the metadata of a file, and the ChunkMetaData of a time series.</p></li> <li><p>IChunkLoader:  IChunkLoader is the loader for Chunk, whose main function is getting the corresponding Chunk of the given the ChunkMetaData.</p></li> <li><p>IChunkReader: IChunkReader reads the data in a Chunk. It receives a Chunk and parse it according to the info in the ChunkHeader. It provides two interface:</p> <ul><li>hasNextSatisfiedPage &amp; nextPageData: iteratively returns a Page</li> <li>getPageReaderList: return all PageReader</li></ul></li> <li><p>IPageReader: IPageReader reads the data in a Page. It provides two interface:</p> <ul><li>getAllSatisfiedPageData(): return all satisfying values</li> <li>getStatistics(): return the statistic information of the Page</li></ul></li> <li><p>QueryExpression</p> <p>QueryExpression is the query expression, which contains the time series to project, and filter constraints.</p></li> <li><p>QueryDataSet</p> <p>The result of a query. It contains one or multiple RowRecord, which combines data points having identical time stamp together. QueryDataSet provides two interface:</p> <ul><li>check if there's a next RowRecord.</li> <li>return the next RowRecord.</li></ul></li></ul></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/SystemDesign/TsFile/Write.html" class="prev">
          Write
        </a></span> <span class="next"><a href="/SystemDesign/QueryEngine/QueryEngine.html">
          QueryEngine
        </a>
        →
      </span></p></div> <p style="text-align: center; color: #909399; font-size: 12px">Copyright © 2021 The Apache Software Foundation.<br>
      Apache and the Apache feather logo are trademarks of The Apache Software Foundation</p> <p style="text-align: center; margin-top: 10px; color: #909399; font-size: 12px"><strong>Have a question?</strong> Connect with us on QQ, WeChat, or Slack. <a href="https://github.com/apache/iotdb/issues/1995">Join the community</a> now.</p> <p style="text-align: center; margin-top: 10px; color: #909399; font-size: 12px">
      We use <a href="https://analytics.google.com">Google Analytics</a> to collect anonymous, aggregated usage information.
  </p></main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.7e72c28b.js" defer></script><script src="/assets/js/3.c53a3153.js" defer></script><script src="/assets/js/4.8cacb85f.js" defer></script><script src="/assets/js/9.340bbf81.js" defer></script>
  </body>
</html>