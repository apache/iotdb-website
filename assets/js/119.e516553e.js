(window.webpackJsonp=window.webpackJsonp||[]).push([[119],{521:function(t,e,s){"use strict";s.r(e);var a=s(19),n=Object(a.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"continuous-query-cq"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#continuous-query-cq"}},[t._v("#")]),t._v(" Continuous Query(CQ)")]),t._v(" "),e("h2",{attrs:{id:"introduction"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#introduction"}},[t._v("#")]),t._v(" Introduction")]),t._v(" "),e("p",[t._v("Continuous queries(CQ) are queries that run automatically and periodically on realtime data and store query results in other specified time series.")]),t._v(" "),e("h2",{attrs:{id:"syntax"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#syntax"}},[t._v("#")]),t._v(" Syntax")]),t._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CONTINUOUS QUERY "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" CQ"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("cq_id"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" \n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("RESAMPLE \n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("EVERY "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("every_interval"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" \n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("BOUNDARY "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("execution_boundary_time"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("RANGE "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("start_time_offset"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" end_time_offset"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" \n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("TIMEOUT POLICY BLOCKED"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DISCARD")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BEGIN")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" CLAUSE\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" CLAUSE\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" CLAUSE\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" CLAUSE"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("group_by_interval"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("sliding_step"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("level")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("level")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("HAVING")]),t._v(" CLAUSE"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("FILL {PREVIOUS "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" LINEAR "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" constant}"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LIMIT")]),t._v(" rowLimit "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OFFSET")]),t._v(" rowOffset"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("ALIGN "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" DEVICE"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("END")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br")])]),e("blockquote",[e("p",[t._v("Note:")]),t._v(" "),e("ol",[e("li",[t._v("If there exists any time filters in WHERE CLAUSE, IoTDB will throw an error, because IoTDB will automatically generate a time range for the query each time it's executed.")]),t._v(" "),e("li",[t._v("GROUP BY TIME CLAUSE is different, it doesn't contain its original first display window parameter which is [start_time, end_time). It's still because IoTDB will automatically generate a time range for the query each time it's executed.")]),t._v(" "),e("li",[t._v("If there is no group by time clause in query, EVERY clause is required, otherwise IoTDB will throw an error.")])])]),t._v(" "),e("h3",{attrs:{id:"descriptions-of-parameters-in-cq-syntax"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#descriptions-of-parameters-in-cq-syntax"}},[t._v("#")]),t._v(" Descriptions of parameters in CQ syntax")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("<cq_id>")]),t._v(" specifies the globally unique id of CQ.")]),t._v(" "),e("li",[e("code",[t._v("<every_interval>")]),t._v(" specifies the query execution time interval. We currently support the units of ns, us, ms, s, m, h, d, w, and its value should not be lower than the minimum threshold configured by the user, which is "),e("code",[t._v("continuous_query_min_every_interval")]),t._v(". It's an optional parameter, default value is set to "),e("code",[t._v("group_by_interval")]),t._v(" in group by clause.")]),t._v(" "),e("li",[e("code",[t._v("<start_time_offset>")]),t._v(" specifies the start time of each query execution as "),e("code",[t._v("now()-<start_time_offset>")]),t._v(". We currently support the units of ns, us, ms, s, m, h, d, w.It's an optional parameter, default value is set to "),e("code",[t._v("every_interval")]),t._v(" in resample clause.")]),t._v(" "),e("li",[e("code",[t._v("<end_time_offset>")]),t._v(" specifies the end time of each query execution as "),e("code",[t._v("now()-<end_time_offset>")]),t._v(". We currently support the units of ns, us, ms, s, m, h, d, w.It's an optional parameter, default value is set to "),e("code",[t._v("0")]),t._v(".")]),t._v(" "),e("li",[e("code",[t._v("<execution_boundary_time>")]),t._v(" is a date that represents the execution time of a certain cq task.\n"),e("ul",[e("li",[e("code",[t._v("<execution_boundary_time>")]),t._v(" can be earlier than, equals to, later than "),e("strong",[t._v("current time")]),t._v(".")]),t._v(" "),e("li",[t._v("This parameter is optional. If not specified, it is equal to "),e("code",[t._v("BOUNDARY 0")]),t._v("。")]),t._v(" "),e("li",[e("strong",[t._v("The start time of the first time window")]),t._v(" is "),e("code",[t._v("<execution_boundary_time> - <start_time_offset>")]),t._v(".")]),t._v(" "),e("li",[e("strong",[t._v("The end time of the first time window")]),t._v(" is "),e("code",[t._v("<execution_boundary_time> - <end_time_offset>")]),t._v(".")]),t._v(" "),e("li",[t._v("The "),e("strong",[t._v("time range")]),t._v(" of the "),e("code",[t._v("i (1 <= i)th")]),t._v(" window is "),e("code",[t._v("[<execution_boundary_time> - <start_time_offset> + (i - 1) * <every_interval>, <execution_boundary_time> - <end_time_offset> + (i - 1) * <every_interval>)")]),t._v(".")]),t._v(" "),e("li",[t._v("If the "),e("strong",[t._v("current time")]),t._v(" is earlier than or equal to "),e("code",[t._v("execution_boundary_time")]),t._v(", then the first execution moment of the continuous query is "),e("code",[t._v("execution_boundary_time")]),t._v(".")]),t._v(" "),e("li",[t._v("If the "),e("strong",[t._v("current time")]),t._v(" is later than "),e("code",[t._v("execution_boundary_time")]),t._v(", then the first execution moment of the continuous query is the first "),e("code",[t._v("execution_boundary_time + i * <every_interval>")]),t._v(" that is later than or equal to the current time .")])])])]),t._v(" "),e("blockquote",[e("ul",[e("li",[e("code",[t._v("<every_interval>")]),t._v("，"),e("code",[t._v("<start_time_offset>")]),t._v(" and "),e("code",[t._v("<group_by_interval>")]),t._v(" should all be greater than "),e("code",[t._v("0")]),t._v(".")]),t._v(" "),e("li",[t._v("The value of "),e("code",[t._v("<group_by_interval>")]),t._v(" should be less than or equal to the value of "),e("code",[t._v("<start_time_offset>")]),t._v(", otherwise the system will throw an error.")]),t._v(" "),e("li",[t._v("Users should specify the appropriate "),e("code",[t._v("<start_time_offset>")]),t._v(" and "),e("code",[t._v("<every_interval>")]),t._v(" according to actual needs.\n"),e("ul",[e("li",[t._v("If "),e("code",[t._v("<start_time_offset>")]),t._v(" is greater than "),e("code",[t._v("<every_interval>")]),t._v(",  there will be partial data overlap in each query window.")]),t._v(" "),e("li",[t._v("If "),e("code",[t._v("<start_time_offset>")]),t._v(" is less than "),e("code",[t._v("<every_interval>")]),t._v(", there may be uncovered data between each query window.")])])]),t._v(" "),e("li",[e("code",[t._v("start_time_offset")]),t._v(" should be larger than "),e("code",[t._v("end_time_offset")]),t._v(", otherwise the system will throw an error.")])])]),t._v(" "),e("h4",{attrs:{id:"start-time-offset-every-interval"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#start-time-offset-every-interval"}},[t._v("#")]),t._v(" "),e("code",[t._v("<start_time_offset>")]),t._v(" == "),e("code",[t._v("<every_interval>")])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://github.com/apache/iotdb-bin-resources/blob/main/docs/UserGuide/Process-Data/Continuous-Query/pic1.png?raw=true",alt:"1"}})]),t._v(" "),e("h4",{attrs:{id:"start-time-offset-every-interval-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#start-time-offset-every-interval-2"}},[t._v("#")]),t._v(" "),e("code",[t._v("<start_time_offset>")]),t._v(" > "),e("code",[t._v("<every_interval>")])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://github.com/apache/iotdb-bin-resources/blob/main/docs/UserGuide/Process-Data/Continuous-Query/pic2.png?raw=true",alt:"2"}})]),t._v(" "),e("h4",{attrs:{id:"start-time-offset-every-interval-3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#start-time-offset-every-interval-3"}},[t._v("#")]),t._v(" "),e("code",[t._v("<start_time_offset>")]),t._v(" < "),e("code",[t._v("<every_interval>")])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://github.com/apache/iotdb-bin-resources/blob/main/docs/UserGuide/Process-Data/Continuous-Query/pic3.png?raw=true",alt:"3"}})]),t._v(" "),e("h4",{attrs:{id:"every-interval-is-not-zero"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#every-interval-is-not-zero"}},[t._v("#")]),t._v(" "),e("code",[t._v("<every_interval>")]),t._v("  is not zero")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://github.com/apache/iotdb-bin-resources/blob/main/docs/UserGuide/Process-Data/Continuous-Query/pic4.png?raw=true",alt:"4"}})]),t._v(" "),e("ul",[e("li",[e("code",[t._v("TIMEOUT POLICY")]),t._v(" specify how we deal with the cq task whose previous time interval execution is not finished while the next execution time has reached. The default value is "),e("code",[t._v("BLOCKED")]),t._v(".\n"),e("ul",[e("li",[e("code",[t._v("BLOCKED")]),t._v(" means that we will block and wait to do the current cq execution task until the previous time interval cq task finishes. If using "),e("code",[t._v("BLOCKED")]),t._v(" policy, all the time intervals will be executed, but it may be behind the latest time interval.")]),t._v(" "),e("li",[e("code",[t._v("DISCARD")]),t._v(" means that we just discard the current cq execution task and wait for the next execution time and do the next time interval cq task. If using "),e("code",[t._v("DISCARD")]),t._v(" policy, some time intervals won't be executed when the execution time of one cq task is longer than the "),e("code",[t._v("<every_interval>")]),t._v(". However, once a cq task is executed, it will use the latest time interval, so it can catch up at the sacrifice of some time intervals being discarded.")])])])]),t._v(" "),e("h2",{attrs:{id:"examples-of-cq"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#examples-of-cq"}},[t._v("#")]),t._v(" Examples of CQ")]),t._v(" "),e("p",[t._v("The examples below use the following sample data. It's a real time data stream and we can assume that the data arrives on time.")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("+-----------------------------+-----------------------------+-----------------------------+-----------------------------+-----------------------------+\n|                         Time|root.ln.wf02.wt02.temperature|root.ln.wf02.wt01.temperature|root.ln.wf01.wt02.temperature|root.ln.wf01.wt01.temperature|\n+-----------------------------+-----------------------------+-----------------------------+-----------------------------+-----------------------------+\n|2021-05-11T22:18:14.598+08:00|                        121.0|                         72.0|                        183.0|                        115.0|\n|2021-05-11T22:18:19.941+08:00|                          0.0|                         68.0|                         68.0|                        103.0|\n|2021-05-11T22:18:24.949+08:00|                        122.0|                         45.0|                         11.0|                         14.0|\n|2021-05-11T22:18:29.967+08:00|                         47.0|                         14.0|                         59.0|                        181.0|\n|2021-05-11T22:18:34.979+08:00|                        182.0|                        113.0|                         29.0|                        180.0|\n|2021-05-11T22:18:39.990+08:00|                         42.0|                         11.0|                         52.0|                         19.0|\n|2021-05-11T22:18:44.995+08:00|                         78.0|                         38.0|                        123.0|                         52.0|\n|2021-05-11T22:18:49.999+08:00|                        137.0|                        172.0|                        135.0|                        193.0|\n|2021-05-11T22:18:55.003+08:00|                         16.0|                        124.0|                        183.0|                         18.0|\n+-----------------------------+-----------------------------+-----------------------------+-----------------------------+-----------------------------+\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br")])]),e("h3",{attrs:{id:"configuring-execution-intervals"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configuring-execution-intervals"}},[t._v("#")]),t._v(" Configuring execution intervals")]),t._v(" "),e("p",[t._v("Use an "),e("code",[t._v("EVERY")]),t._v(" interval in the "),e("code",[t._v("RESAMPLE")]),t._v(" clause to specify the CQ’s execution interval, if not specific, default value is equal to "),e("code",[t._v("group_by_interval")]),t._v(".")]),t._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" CONTINUOUS QUERY cq1\nRESAMPLE EVERY "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("s\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BEGIN")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" max_value"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temperature"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ln"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wf02"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wt02"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temperature_max"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ln"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wf02"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wt01"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temperature_max"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ln"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wf01"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wt02"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temperature_max"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ln"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wf01"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wt01"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temperature_max"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ln"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("s"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("END")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br")])]),e("p",[e("code",[t._v("cq1")]),t._v(" calculates the 10-second average of "),e("code",[t._v("temperature")]),t._v(" sensor under the "),e("code",[t._v("root.ln")]),t._v(" prefix path and stores the results in the "),e("code",[t._v("temperature_max")]),t._v(" sensor using the same prefix path as the corresponding sensor.")]),t._v(" "),e("p",[e("code",[t._v("cq1")]),t._v(" executes at 20-second intervals, the same interval as the "),e("code",[t._v("EVERY")]),t._v(" interval. Every 20 seconds, "),e("code",[t._v("cq1")]),t._v(" runs a single query that covers the time range for the current time bucket, that is, the 20-second time bucket that intersects with "),e("code",[t._v("now()")]),t._v(".")]),t._v(" "),e("p",[t._v("Supposing that the current time is "),e("code",[t._v("2021-05-11T22:18:40.000+08:00")]),t._v(", we can see annotated log output about "),e("code",[t._v("cq1")]),t._v(" running at DataNode if you set log level to DEBUG:")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("At **2021-05-11T22:18:40.000+08:00**, `cq1` executes a query within the time range `[2021-05-11T22:18:20, 2021-05-11T22:18:40)`.\n`cq1` generate 2 lines:\n>\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|                         Time|root.ln.wf02.wt02.temperature_max|root.ln.wf02.wt01.temperature_max|root.ln.wf01.wt02.temperature_max|root.ln.wf01.wt01.temperature_max|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|2021-05-11T22:18:20.000+08:00|                            122.0|                             45.0|                             59.0|                            181.0|\n|2021-05-11T22:18:30.000+08:00|                            182.0|                            113.0|                             52.0|                            180.0|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n>\nAt **2021-05-11T22:19:00.000+08:00**, `cq1` executes a query within the time range `[2021-05-11T22:18:40, 2021-05-11T22:19:00)`.\n`cq1` generate 2 lines:\n>\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|                         Time|root.ln.wf02.wt02.temperature_max|root.ln.wf02.wt01.temperature_max|root.ln.wf01.wt02.temperature_max|root.ln.wf01.wt01.temperature_max|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|2021-05-11T22:18:40.000+08:00|                            137.0|                            172.0|                            135.0|                            193.0|\n|2021-05-11T22:18:50.000+08:00|                             16.0|                            124.0|                            183.0|                             18.0|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n>\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br"),e("span",{staticClass:"line-number"},[t._v("19")]),e("br"),e("span",{staticClass:"line-number"},[t._v("20")]),e("br")])]),e("p",[e("code",[t._v("cq1")]),t._v(" won't deal with data that is before the current time window which is "),e("code",[t._v("2021-05-11T22:18:20.000+08:00")]),t._v(", so here are the results:")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("> SELECT temperature_max from root.ln.*.*;\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|                         Time|root.ln.wf02.wt02.temperature_max|root.ln.wf02.wt01.temperature_max|root.ln.wf01.wt02.temperature_max|root.ln.wf01.wt01.temperature_max|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|2021-05-11T22:18:20.000+08:00|                            122.0|                             45.0|                             59.0|                            181.0|\n|2021-05-11T22:18:30.000+08:00|                            182.0|                            113.0|                             52.0|                            180.0|\n|2021-05-11T22:18:40.000+08:00|                            137.0|                            172.0|                            135.0|                            193.0|\n|2021-05-11T22:18:50.000+08:00|                             16.0|                            124.0|                            183.0|                             18.0|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br")])]),e("h3",{attrs:{id:"configuring-time-range-for-resampling"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configuring-time-range-for-resampling"}},[t._v("#")]),t._v(" Configuring time range for resampling")]),t._v(" "),e("p",[t._v("Use "),e("code",[t._v("start_time_offset")]),t._v(" in the "),e("code",[t._v("RANGE")]),t._v(" clause to specify the start time of the CQ’s time range, if not specific, default value is equal to "),e("code",[t._v("EVERY")]),t._v(" interval.")]),t._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" CONTINUOUS QUERY cq2\nRESAMPLE RANGE "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("40")]),t._v("s\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BEGIN")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" max_value"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temperature"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ln"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wf02"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wt02"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temperature_max"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ln"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wf02"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wt01"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temperature_max"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ln"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wf01"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wt02"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temperature_max"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ln"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wf01"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wt01"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temperature_max"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ln"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("s"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("END")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br")])]),e("p",[e("code",[t._v("cq2")]),t._v(" calculates the 10-second average of "),e("code",[t._v("temperature")]),t._v(" sensor under the "),e("code",[t._v("root.ln")]),t._v(" prefix path and stores the results in the "),e("code",[t._v("temperature_max")]),t._v(" sensor using the same prefix path as the corresponding sensor.")]),t._v(" "),e("p",[e("code",[t._v("cq2")]),t._v(" executes at 10-second intervals, the same interval as the "),e("code",[t._v("group_by_interval")]),t._v(". Every 10 seconds, "),e("code",[t._v("cq2")]),t._v(" runs a single query that covers the time range between "),e("code",[t._v("now()")]),t._v(" minus the "),e("code",[t._v("start_time_offset")]),t._v(" and "),e("code",[t._v("now()")]),t._v(" , that is, the time range between 40 seconds prior to "),e("code",[t._v("now()")]),t._v(" and "),e("code",[t._v("now()")]),t._v(".")]),t._v(" "),e("p",[t._v("Supposing that the current time is "),e("code",[t._v("2021-05-11T22:18:40.000+08:00")]),t._v(", we can see annotated log output about "),e("code",[t._v("cq2")]),t._v(" running at DataNode if you set log level to DEBUG:")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("At **2021-05-11T22:18:40.000+08:00**, `cq2` executes a query within the time range `[2021-05-11T22:18:00, 2021-05-11T22:18:40)`.\n`cq2` generate 4 lines:\n>\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|                         Time|root.ln.wf02.wt02.temperature_max|root.ln.wf02.wt01.temperature_max|root.ln.wf01.wt02.temperature_max|root.ln.wf01.wt01.temperature_max|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|2021-05-11T22:18:00.000+08:00|                             NULL|                             NULL|                             NULL|                             NULL|\n|2021-05-11T22:18:10.000+08:00|                            121.0|                             72.0|                            183.0|                            115.0|\n|2021-05-11T22:18:20.000+08:00|                            122.0|                             45.0|                             59.0|                            181.0|\n|2021-05-11T22:18:30.000+08:00|                            182.0|                            113.0|                             52.0|                            180.0|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n>\nAt **2021-05-11T22:18:50.000+08:00**, `cq2` executes a query within the time range `[2021-05-11T22:18:10, 2021-05-11T22:18:50)`.\n`cq2` generate 4 lines:\n>\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|                         Time|root.ln.wf02.wt02.temperature_max|root.ln.wf02.wt01.temperature_max|root.ln.wf01.wt02.temperature_max|root.ln.wf01.wt01.temperature_max|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|2021-05-11T22:18:10.000+08:00|                            121.0|                             72.0|                            183.0|                            115.0|\n|2021-05-11T22:18:20.000+08:00|                            122.0|                             45.0|                             59.0|                            181.0|\n|2021-05-11T22:18:30.000+08:00|                            182.0|                            113.0|                             52.0|                            180.0|\n|2021-05-11T22:18:40.000+08:00|                            137.0|                            172.0|                            135.0|                            193.0|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n>\nAt **2021-05-11T22:19:00.000+08:00**, `cq2` executes a query within the time range `[2021-05-11T22:18:20, 2021-05-11T22:19:00)`.\n`cq2` generate 4 lines:\n>\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|                         Time|root.ln.wf02.wt02.temperature_max|root.ln.wf02.wt01.temperature_max|root.ln.wf01.wt02.temperature_max|root.ln.wf01.wt01.temperature_max|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|2021-05-11T22:18:20.000+08:00|                            122.0|                             45.0|                             59.0|                            181.0|\n|2021-05-11T22:18:30.000+08:00|                            182.0|                            113.0|                             52.0|                            180.0|\n|2021-05-11T22:18:40.000+08:00|                            137.0|                            172.0|                            135.0|                            193.0|\n|2021-05-11T22:18:50.000+08:00|                             16.0|                            124.0|                            183.0|                             18.0|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n>\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br"),e("span",{staticClass:"line-number"},[t._v("19")]),e("br"),e("span",{staticClass:"line-number"},[t._v("20")]),e("br"),e("span",{staticClass:"line-number"},[t._v("21")]),e("br"),e("span",{staticClass:"line-number"},[t._v("22")]),e("br"),e("span",{staticClass:"line-number"},[t._v("23")]),e("br"),e("span",{staticClass:"line-number"},[t._v("24")]),e("br"),e("span",{staticClass:"line-number"},[t._v("25")]),e("br"),e("span",{staticClass:"line-number"},[t._v("26")]),e("br"),e("span",{staticClass:"line-number"},[t._v("27")]),e("br"),e("span",{staticClass:"line-number"},[t._v("28")]),e("br"),e("span",{staticClass:"line-number"},[t._v("29")]),e("br"),e("span",{staticClass:"line-number"},[t._v("30")]),e("br"),e("span",{staticClass:"line-number"},[t._v("31")]),e("br"),e("span",{staticClass:"line-number"},[t._v("32")]),e("br"),e("span",{staticClass:"line-number"},[t._v("33")]),e("br"),e("span",{staticClass:"line-number"},[t._v("34")]),e("br"),e("span",{staticClass:"line-number"},[t._v("35")]),e("br"),e("span",{staticClass:"line-number"},[t._v("36")]),e("br")])]),e("p",[e("code",[t._v("cq2")]),t._v(" won't write lines that are all null. Notice "),e("code",[t._v("cq2")]),t._v(" will also calculate the results for some time interval many times. Here are the results:")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("> SELECT temperature_max from root.ln.*.*;\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|                         Time|root.ln.wf02.wt02.temperature_max|root.ln.wf02.wt01.temperature_max|root.ln.wf01.wt02.temperature_max|root.ln.wf01.wt01.temperature_max|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|2021-05-11T22:18:10.000+08:00|                            121.0|                             72.0|                            183.0|                            115.0|\n|2021-05-11T22:18:20.000+08:00|                            122.0|                             45.0|                             59.0|                            181.0|\n|2021-05-11T22:18:30.000+08:00|                            182.0|                            113.0|                             52.0|                            180.0|\n|2021-05-11T22:18:40.000+08:00|                            137.0|                            172.0|                            135.0|                            193.0|\n|2021-05-11T22:18:50.000+08:00|                             16.0|                            124.0|                            183.0|                             18.0|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br")])]),e("h3",{attrs:{id:"configuring-execution-intervals-and-cq-time-ranges"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configuring-execution-intervals-and-cq-time-ranges"}},[t._v("#")]),t._v(" Configuring execution intervals and CQ time ranges")]),t._v(" "),e("p",[t._v("Use an "),e("code",[t._v("EVERY")]),t._v(" interval and "),e("code",[t._v("RANGE")]),t._v(" interval in the "),e("code",[t._v("RESAMPLE")]),t._v(" clause to specify the CQ’s execution interval and the length of the CQ’s time range. And use "),e("code",[t._v("fill()")]),t._v(" to change the value reported for time intervals with no data.")]),t._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" CONTINUOUS QUERY cq3\nRESAMPLE EVERY "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("s RANGE "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("40")]),t._v("s\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BEGIN")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" max_value"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temperature"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ln"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wf02"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wt02"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temperature_max"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ln"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wf02"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wt01"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temperature_max"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ln"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wf01"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wt02"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temperature_max"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ln"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wf01"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wt01"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temperature_max"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ln"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("s"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  FILL"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("100.0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("END")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br")])]),e("p",[e("code",[t._v("cq3")]),t._v(" calculates the 10-second average of "),e("code",[t._v("temperature")]),t._v(" sensor under the "),e("code",[t._v("root.ln")]),t._v(" prefix path and stores the results in the "),e("code",[t._v("temperature_max")]),t._v(" sensor using the same prefix path as the corresponding sensor. Where possible, it writes the value "),e("code",[t._v("100.0")]),t._v(" for time intervals with no results.")]),t._v(" "),e("p",[e("code",[t._v("cq3")]),t._v(" executes at 20-second intervals, the same interval as the "),e("code",[t._v("EVERY")]),t._v(" interval. Every 20 seconds, "),e("code",[t._v("cq3")]),t._v(" runs a single query that covers the time range between "),e("code",[t._v("now()")]),t._v(" minus the "),e("code",[t._v("start_time_offset")]),t._v(" and "),e("code",[t._v("now()")]),t._v(", that is, the time range between 40 seconds prior to "),e("code",[t._v("now()")]),t._v(" and "),e("code",[t._v("now()")]),t._v(".")]),t._v(" "),e("p",[t._v("Supposing that the current time is "),e("code",[t._v("2021-05-11T22:18:40.000+08:00")]),t._v(", we can see annotated log output about "),e("code",[t._v("cq3")]),t._v(" running at DataNode if you set log level to DEBUG:")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("At **2021-05-11T22:18:40.000+08:00**, `cq3` executes a query within the time range `[2021-05-11T22:18:00, 2021-05-11T22:18:40)`.\n`cq3` generate 4 lines:\n>\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|                         Time|root.ln.wf02.wt02.temperature_max|root.ln.wf02.wt01.temperature_max|root.ln.wf01.wt02.temperature_max|root.ln.wf01.wt01.temperature_max|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|2021-05-11T22:18:00.000+08:00|                            100.0|                            100.0|                            100.0|                            100.0|\n|2021-05-11T22:18:10.000+08:00|                            121.0|                             72.0|                            183.0|                            115.0|\n|2021-05-11T22:18:20.000+08:00|                            122.0|                             45.0|                             59.0|                            181.0|\n|2021-05-11T22:18:30.000+08:00|                            182.0|                            113.0|                             52.0|                            180.0|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n>\nAt **2021-05-11T22:19:00.000+08:00**, `cq3` executes a query within the time range `[2021-05-11T22:18:20, 2021-05-11T22:19:00)`.\n`cq3` generate 4 lines:\n>\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|                         Time|root.ln.wf02.wt02.temperature_max|root.ln.wf02.wt01.temperature_max|root.ln.wf01.wt02.temperature_max|root.ln.wf01.wt01.temperature_max|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|2021-05-11T22:18:20.000+08:00|                            122.0|                             45.0|                             59.0|                            181.0|\n|2021-05-11T22:18:30.000+08:00|                            182.0|                            113.0|                             52.0|                            180.0|\n|2021-05-11T22:18:40.000+08:00|                            137.0|                            172.0|                            135.0|                            193.0|\n|2021-05-11T22:18:50.000+08:00|                             16.0|                            124.0|                            183.0|                             18.0|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n>\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br"),e("span",{staticClass:"line-number"},[t._v("19")]),e("br"),e("span",{staticClass:"line-number"},[t._v("20")]),e("br"),e("span",{staticClass:"line-number"},[t._v("21")]),e("br"),e("span",{staticClass:"line-number"},[t._v("22")]),e("br"),e("span",{staticClass:"line-number"},[t._v("23")]),e("br"),e("span",{staticClass:"line-number"},[t._v("24")]),e("br")])]),e("p",[t._v("Notice that "),e("code",[t._v("cq3")]),t._v(" will calculate the results for some time interval many times, so here are the results:")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("> SELECT temperature_max from root.ln.*.*;\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|                         Time|root.ln.wf02.wt02.temperature_max|root.ln.wf02.wt01.temperature_max|root.ln.wf01.wt02.temperature_max|root.ln.wf01.wt01.temperature_max|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|2021-05-11T22:18:00.000+08:00|                            100.0|                            100.0|                            100.0|                            100.0|\n|2021-05-11T22:18:10.000+08:00|                            121.0|                             72.0|                            183.0|                            115.0|\n|2021-05-11T22:18:20.000+08:00|                            122.0|                             45.0|                             59.0|                            181.0|\n|2021-05-11T22:18:30.000+08:00|                            182.0|                            113.0|                             52.0|                            180.0|\n|2021-05-11T22:18:40.000+08:00|                            137.0|                            172.0|                            135.0|                            193.0|\n|2021-05-11T22:18:50.000+08:00|                             16.0|                            124.0|                            183.0|                             18.0|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br")])]),e("h3",{attrs:{id:"configuring-end-time-offset-for-cq-time-range"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configuring-end-time-offset-for-cq-time-range"}},[t._v("#")]),t._v(" Configuring end_time_offset for CQ time range")]),t._v(" "),e("p",[t._v("Use an "),e("code",[t._v("EVERY")]),t._v(" interval and "),e("code",[t._v("RANGE")]),t._v(" interval in the RESAMPLE clause to specify the CQ’s execution interval and the length of the CQ’s time range. And use "),e("code",[t._v("fill()")]),t._v(" to change the value reported for time intervals with no data.")]),t._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" CONTINUOUS QUERY cq4\nRESAMPLE EVERY "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("s RANGE "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("40")]),t._v("s"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("s\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BEGIN")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" max_value"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temperature"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ln"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wf02"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wt02"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temperature_max"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ln"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wf02"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wt01"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temperature_max"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ln"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wf01"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wt02"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temperature_max"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ln"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wf01"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wt01"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temperature_max"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ln"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("s"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  FILL"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("100.0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("END")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br")])]),e("p",[e("code",[t._v("cq4")]),t._v(" calculates the 10-second average of "),e("code",[t._v("temperature")]),t._v(" sensor under the "),e("code",[t._v("root.ln")]),t._v(" prefix path and stores the results in the "),e("code",[t._v("temperature_max")]),t._v(" sensor using the same prefix path as the corresponding sensor. Where possible, it writes the value "),e("code",[t._v("100.0")]),t._v(" for time intervals with no results.")]),t._v(" "),e("p",[e("code",[t._v("cq4")]),t._v(" executes at 20-second intervals, the same interval as the "),e("code",[t._v("EVERY")]),t._v(" interval. Every 20 seconds, "),e("code",[t._v("cq4")]),t._v(" runs a single query that covers the time range between "),e("code",[t._v("now()")]),t._v(" minus the "),e("code",[t._v("start_time_offset")]),t._v(" and "),e("code",[t._v("now()")]),t._v(" minus the "),e("code",[t._v("end_time_offset")]),t._v(", that is, the time range between  40 seconds prior to "),e("code",[t._v("now()")]),t._v(" and 20 seconds prior to "),e("code",[t._v("now()")]),t._v(".")]),t._v(" "),e("p",[t._v("Supposing that the current time is "),e("code",[t._v("2021-05-11T22:18:40.000+08:00")]),t._v(", we can see annotated log output about "),e("code",[t._v("cq4")]),t._v(" running at DataNode if you set log level to DEBUG:")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("At **2021-05-11T22:18:40.000+08:00**, `cq4` executes a query within the time range `[2021-05-11T22:18:00, 2021-05-11T22:18:20)`.\n`cq4` generate 2 lines:\n>\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|                         Time|root.ln.wf02.wt02.temperature_max|root.ln.wf02.wt01.temperature_max|root.ln.wf01.wt02.temperature_max|root.ln.wf01.wt01.temperature_max|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|2021-05-11T22:18:00.000+08:00|                            100.0|                            100.0|                            100.0|                            100.0|\n|2021-05-11T22:18:10.000+08:00|                            121.0|                             72.0|                            183.0|                            115.0|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n>\nAt **2021-05-11T22:19:00.000+08:00**, `cq4` executes a query within the time range `[2021-05-11T22:18:20, 2021-05-11T22:18:40)`.\n`cq4` generate 2 lines:\n>\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|                         Time|root.ln.wf02.wt02.temperature_max|root.ln.wf02.wt01.temperature_max|root.ln.wf01.wt02.temperature_max|root.ln.wf01.wt01.temperature_max|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|2021-05-11T22:18:20.000+08:00|                            122.0|                             45.0|                             59.0|                            181.0|\n|2021-05-11T22:18:30.000+08:00|                            182.0|                            113.0|                             52.0|                            180.0|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n>\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br"),e("span",{staticClass:"line-number"},[t._v("19")]),e("br"),e("span",{staticClass:"line-number"},[t._v("20")]),e("br")])]),e("p",[t._v("Notice that "),e("code",[t._v("cq4")]),t._v(" will calculate the results for all time intervals only once after a delay of 20 seconds, so here are the results:")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("> SELECT temperature_max from root.ln.*.*;\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|                         Time|root.ln.wf02.wt02.temperature_max|root.ln.wf02.wt01.temperature_max|root.ln.wf01.wt02.temperature_max|root.ln.wf01.wt01.temperature_max|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n|2021-05-11T22:18:00.000+08:00|                            100.0|                            100.0|                            100.0|                            100.0|\n|2021-05-11T22:18:10.000+08:00|                            121.0|                             72.0|                            183.0|                            115.0|\n|2021-05-11T22:18:20.000+08:00|                            122.0|                             45.0|                             59.0|                            181.0|\n|2021-05-11T22:18:30.000+08:00|                            182.0|                            113.0|                             52.0|                            180.0|\n+-----------------------------+---------------------------------+---------------------------------+---------------------------------+---------------------------------+\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br")])]),e("h3",{attrs:{id:"cq-without-group-by-clause"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cq-without-group-by-clause"}},[t._v("#")]),t._v(" CQ without group by clause")]),t._v(" "),e("p",[t._v("Use an "),e("code",[t._v("EVERY")]),t._v(" interval in the "),e("code",[t._v("RESAMPLE")]),t._v(" clause to specify the CQ’s execution interval and the length of the CQ’s time range.")]),t._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" CONTINUOUS QUERY cq5\nRESAMPLE EVERY "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("s\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BEGIN")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" temperature "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("precalculated_sg"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("::"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temperature"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ln"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n  align "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" device\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("END")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br")])]),e("p",[e("code",[t._v("cq5")]),t._v(" calculates the "),e("code",[t._v("temperature + 1")]),t._v(" under the "),e("code",[t._v("root.ln")]),t._v(" prefix path and stores the results in the "),e("code",[t._v("root.precalculated_sg")]),t._v(" database. Sensors use the same prefix path as the corresponding sensor.")]),t._v(" "),e("p",[e("code",[t._v("cq5")]),t._v(" executes at 20-second intervals, the same interval as the "),e("code",[t._v("EVERY")]),t._v(" interval. Every 20 seconds, "),e("code",[t._v("cq5")]),t._v(" runs a single query that covers the time range for the current time bucket, that is, the 20-second time bucket that intersects with "),e("code",[t._v("now()")]),t._v(".")]),t._v(" "),e("p",[t._v("Supposing that the current time is "),e("code",[t._v("2021-05-11T22:18:40.000+08:00")]),t._v(", we can see annotated log output about "),e("code",[t._v("cq5")]),t._v(" running at DataNode if you set log level to DEBUG:")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("At **2021-05-11T22:18:40.000+08:00**, `cq5` executes a query within the time range `[2021-05-11T22:18:20, 2021-05-11T22:18:40)`.\n`cq5` generate 16 lines:\n>\n+-----------------------------+-------------------------------+-----------+\n|                         Time|                         Device|temperature|\n+-----------------------------+-------------------------------+-----------+\n|2021-05-11T22:18:24.949+08:00|root.precalculated_sg.wf02.wt02|      123.0| \n|2021-05-11T22:18:29.967+08:00|root.precalculated_sg.wf02.wt02|       48.0|\n|2021-05-11T22:18:34.979+08:00|root.precalculated_sg.wf02.wt02|      183.0|\n|2021-05-11T22:18:39.990+08:00|root.precalculated_sg.wf02.wt02|       45.0|\n|2021-05-11T22:18:24.949+08:00|root.precalculated_sg.wf02.wt01|       46.0| \n|2021-05-11T22:18:29.967+08:00|root.precalculated_sg.wf02.wt01|       15.0|\n|2021-05-11T22:18:34.979+08:00|root.precalculated_sg.wf02.wt01|      114.0|\n|2021-05-11T22:18:39.990+08:00|root.precalculated_sg.wf02.wt01|       12.0|\n|2021-05-11T22:18:24.949+08:00|root.precalculated_sg.wf01.wt02|       12.0| \n|2021-05-11T22:18:29.967+08:00|root.precalculated_sg.wf01.wt02|       60.0|\n|2021-05-11T22:18:34.979+08:00|root.precalculated_sg.wf01.wt02|       30.0|\n|2021-05-11T22:18:39.990+08:00|root.precalculated_sg.wf01.wt02|       53.0|\n|2021-05-11T22:18:24.949+08:00|root.precalculated_sg.wf01.wt01|       15.0| \n|2021-05-11T22:18:29.967+08:00|root.precalculated_sg.wf01.wt01|      182.0|\n|2021-05-11T22:18:34.979+08:00|root.precalculated_sg.wf01.wt01|      181.0|\n|2021-05-11T22:18:39.990+08:00|root.precalculated_sg.wf01.wt01|       20.0|\n+-----------------------------+-------------------------------+-----------+\n>\nAt **2021-05-11T22:19:00.000+08:00**, `cq5` executes a query within the time range `[2021-05-11T22:18:40, 2021-05-11T22:19:00)`.\n`cq5` generate 12 lines:\n>\n+-----------------------------+-------------------------------+-----------+\n|                         Time|                         Device|temperature|\n+-----------------------------+-------------------------------+-----------+\n|2021-05-11T22:18:44.995+08:00|root.precalculated_sg.wf02.wt02|       79.0| \n|2021-05-11T22:18:49.999+08:00|root.precalculated_sg.wf02.wt02|      138.0|\n|2021-05-11T22:18:55.003+08:00|root.precalculated_sg.wf02.wt02|       17.0|\n|2021-05-11T22:18:44.995+08:00|root.precalculated_sg.wf02.wt01|       39.0| \n|2021-05-11T22:18:49.999+08:00|root.precalculated_sg.wf02.wt01|      173.0|\n|2021-05-11T22:18:55.003+08:00|root.precalculated_sg.wf02.wt01|      125.0|\n|2021-05-11T22:18:44.995+08:00|root.precalculated_sg.wf01.wt02|      124.0| \n|2021-05-11T22:18:49.999+08:00|root.precalculated_sg.wf01.wt02|      136.0|\n|2021-05-11T22:18:55.003+08:00|root.precalculated_sg.wf01.wt02|      184.0|\n|2021-05-11T22:18:44.995+08:00|root.precalculated_sg.wf01.wt01|       53.0| \n|2021-05-11T22:18:49.999+08:00|root.precalculated_sg.wf01.wt01|      194.0|\n|2021-05-11T22:18:55.003+08:00|root.precalculated_sg.wf01.wt01|       19.0|\n+-----------------------------+-------------------------------+-----------+\n>\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br"),e("span",{staticClass:"line-number"},[t._v("19")]),e("br"),e("span",{staticClass:"line-number"},[t._v("20")]),e("br"),e("span",{staticClass:"line-number"},[t._v("21")]),e("br"),e("span",{staticClass:"line-number"},[t._v("22")]),e("br"),e("span",{staticClass:"line-number"},[t._v("23")]),e("br"),e("span",{staticClass:"line-number"},[t._v("24")]),e("br"),e("span",{staticClass:"line-number"},[t._v("25")]),e("br"),e("span",{staticClass:"line-number"},[t._v("26")]),e("br"),e("span",{staticClass:"line-number"},[t._v("27")]),e("br"),e("span",{staticClass:"line-number"},[t._v("28")]),e("br"),e("span",{staticClass:"line-number"},[t._v("29")]),e("br"),e("span",{staticClass:"line-number"},[t._v("30")]),e("br"),e("span",{staticClass:"line-number"},[t._v("31")]),e("br"),e("span",{staticClass:"line-number"},[t._v("32")]),e("br"),e("span",{staticClass:"line-number"},[t._v("33")]),e("br"),e("span",{staticClass:"line-number"},[t._v("34")]),e("br"),e("span",{staticClass:"line-number"},[t._v("35")]),e("br"),e("span",{staticClass:"line-number"},[t._v("36")]),e("br"),e("span",{staticClass:"line-number"},[t._v("37")]),e("br"),e("span",{staticClass:"line-number"},[t._v("38")]),e("br"),e("span",{staticClass:"line-number"},[t._v("39")]),e("br"),e("span",{staticClass:"line-number"},[t._v("40")]),e("br"),e("span",{staticClass:"line-number"},[t._v("41")]),e("br"),e("span",{staticClass:"line-number"},[t._v("42")]),e("br"),e("span",{staticClass:"line-number"},[t._v("43")]),e("br"),e("span",{staticClass:"line-number"},[t._v("44")]),e("br")])]),e("p",[e("code",[t._v("cq5")]),t._v(" won't deal with data that is before the current time window which is "),e("code",[t._v("2021-05-11T22:18:20.000+08:00")]),t._v(", so here are the results:")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("> SELECT temperature from root.precalculated_sg.*.* align by device;\n+-----------------------------+-------------------------------+-----------+\n|                         Time|                         Device|temperature|\n+-----------------------------+-------------------------------+-----------+\n|2021-05-11T22:18:24.949+08:00|root.precalculated_sg.wf02.wt02|      123.0| \n|2021-05-11T22:18:29.967+08:00|root.precalculated_sg.wf02.wt02|       48.0|\n|2021-05-11T22:18:34.979+08:00|root.precalculated_sg.wf02.wt02|      183.0|\n|2021-05-11T22:18:39.990+08:00|root.precalculated_sg.wf02.wt02|       45.0|\n|2021-05-11T22:18:44.995+08:00|root.precalculated_sg.wf02.wt02|       79.0| \n|2021-05-11T22:18:49.999+08:00|root.precalculated_sg.wf02.wt02|      138.0|\n|2021-05-11T22:18:55.003+08:00|root.precalculated_sg.wf02.wt02|       17.0|\n|2021-05-11T22:18:24.949+08:00|root.precalculated_sg.wf02.wt01|       46.0| \n|2021-05-11T22:18:29.967+08:00|root.precalculated_sg.wf02.wt01|       15.0|\n|2021-05-11T22:18:34.979+08:00|root.precalculated_sg.wf02.wt01|      114.0|\n|2021-05-11T22:18:39.990+08:00|root.precalculated_sg.wf02.wt01|       12.0|\n|2021-05-11T22:18:44.995+08:00|root.precalculated_sg.wf02.wt01|       39.0| \n|2021-05-11T22:18:49.999+08:00|root.precalculated_sg.wf02.wt01|      173.0|\n|2021-05-11T22:18:55.003+08:00|root.precalculated_sg.wf02.wt01|      125.0|\n|2021-05-11T22:18:24.949+08:00|root.precalculated_sg.wf01.wt02|       12.0| \n|2021-05-11T22:18:29.967+08:00|root.precalculated_sg.wf01.wt02|       60.0|\n|2021-05-11T22:18:34.979+08:00|root.precalculated_sg.wf01.wt02|       30.0|\n|2021-05-11T22:18:39.990+08:00|root.precalculated_sg.wf01.wt02|       53.0|\n|2021-05-11T22:18:44.995+08:00|root.precalculated_sg.wf01.wt02|      124.0| \n|2021-05-11T22:18:49.999+08:00|root.precalculated_sg.wf01.wt02|      136.0|\n|2021-05-11T22:18:55.003+08:00|root.precalculated_sg.wf01.wt02|      184.0|\n|2021-05-11T22:18:24.949+08:00|root.precalculated_sg.wf01.wt01|       15.0| \n|2021-05-11T22:18:29.967+08:00|root.precalculated_sg.wf01.wt01|      182.0|\n|2021-05-11T22:18:34.979+08:00|root.precalculated_sg.wf01.wt01|      181.0|\n|2021-05-11T22:18:39.990+08:00|root.precalculated_sg.wf01.wt01|       20.0|\n|2021-05-11T22:18:44.995+08:00|root.precalculated_sg.wf01.wt01|       53.0| \n|2021-05-11T22:18:49.999+08:00|root.precalculated_sg.wf01.wt01|      194.0|\n|2021-05-11T22:18:55.003+08:00|root.precalculated_sg.wf01.wt01|       19.0|\n+-----------------------------+-------------------------------+-----------+\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br"),e("span",{staticClass:"line-number"},[t._v("19")]),e("br"),e("span",{staticClass:"line-number"},[t._v("20")]),e("br"),e("span",{staticClass:"line-number"},[t._v("21")]),e("br"),e("span",{staticClass:"line-number"},[t._v("22")]),e("br"),e("span",{staticClass:"line-number"},[t._v("23")]),e("br"),e("span",{staticClass:"line-number"},[t._v("24")]),e("br"),e("span",{staticClass:"line-number"},[t._v("25")]),e("br"),e("span",{staticClass:"line-number"},[t._v("26")]),e("br"),e("span",{staticClass:"line-number"},[t._v("27")]),e("br"),e("span",{staticClass:"line-number"},[t._v("28")]),e("br"),e("span",{staticClass:"line-number"},[t._v("29")]),e("br"),e("span",{staticClass:"line-number"},[t._v("30")]),e("br"),e("span",{staticClass:"line-number"},[t._v("31")]),e("br"),e("span",{staticClass:"line-number"},[t._v("32")]),e("br"),e("span",{staticClass:"line-number"},[t._v("33")]),e("br")])]),e("h2",{attrs:{id:"cq-management"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cq-management"}},[t._v("#")]),t._v(" CQ Management")]),t._v(" "),e("h3",{attrs:{id:"listing-continuous-queries"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#listing-continuous-queries"}},[t._v("#")]),t._v(" Listing continuous queries")]),t._v(" "),e("p",[t._v("List every CQ on the IoTDB Cluster with:")]),t._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SHOW")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CONTINUOUS QUERIES "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" CQS"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[e("code",[t._v("SHOW (CONTINUOUS QUERIES | CQS)")]),t._v(" order results by "),e("code",[t._v("cq_id")]),t._v(".")]),t._v(" "),e("h4",{attrs:{id:"examples"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#examples"}},[t._v("#")]),t._v(" Examples")]),t._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SHOW")]),t._v(" CONTINUOUS QUERIES"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("we will get:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("cq_id")]),t._v(" "),e("th",[t._v("query")]),t._v(" "),e("th",[t._v("state")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("s1_count_cq")]),t._v(" "),e("td",[t._v("CREATE CQ s1_count_cq"),e("br"),t._v("BEGIN"),e("br"),t._v("SELECT count(s1)"),e("br"),t._v("INTO root.sg_count.d.count_s1"),e("br"),t._v("FROM root.sg.d"),e("br"),t._v("GROUP BY(30m)"),e("br"),t._v("END")]),t._v(" "),e("td",[t._v("active")])])])]),t._v(" "),e("h3",{attrs:{id:"dropping-continuous-queries"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#dropping-continuous-queries"}},[t._v("#")]),t._v(" Dropping continuous queries")]),t._v(" "),e("p",[t._v("Drop a CQ with a specific "),e("code",[t._v("cq_id")]),t._v(":")]),t._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DROP")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CONTINUOUS QUERY "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" CQ"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("cq_id"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("DROP CQ returns an empty result.")]),t._v(" "),e("h4",{attrs:{id:"examples-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#examples-2"}},[t._v("#")]),t._v(" Examples")]),t._v(" "),e("p",[t._v("Drop the CQ named "),e("code",[t._v("s1_count_cq")]),t._v(":")]),t._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DROP")]),t._v(" CONTINUOUS QUERY s1_count_cq"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("h3",{attrs:{id:"altering-continuous-queries"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#altering-continuous-queries"}},[t._v("#")]),t._v(" Altering continuous queries")]),t._v(" "),e("p",[t._v("CQs can't be altered once they're created. To change a CQ, you must "),e("code",[t._v("DROP")]),t._v(" and re"),e("code",[t._v("CREATE")]),t._v(" it with the updated settings.")]),t._v(" "),e("h2",{attrs:{id:"cq-use-cases"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cq-use-cases"}},[t._v("#")]),t._v(" CQ Use Cases")]),t._v(" "),e("h3",{attrs:{id:"downsampling-and-data-retention"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#downsampling-and-data-retention"}},[t._v("#")]),t._v(" Downsampling and Data Retention")]),t._v(" "),e("p",[t._v("Use CQs with "),e("code",[t._v("TTL")]),t._v(" set on database in IoTDB to mitigate storage concerns. Combine CQs and "),e("code",[t._v("TTL")]),t._v(" to automatically downsample high precision data to a lower precision and remove the dispensable, high precision data from the database.")]),t._v(" "),e("h3",{attrs:{id:"recalculating-expensive-queries"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#recalculating-expensive-queries"}},[t._v("#")]),t._v(" Recalculating expensive queries")]),t._v(" "),e("p",[t._v("Shorten query runtimes by pre-calculating expensive queries with CQs. Use a CQ to automatically downsample commonly-queried, high precision data to a lower precision. Queries on lower precision data require fewer resources and return faster.")]),t._v(" "),e("blockquote",[e("p",[t._v("Pre-calculate queries for your preferred graphing tool to accelerate the population of graphs and dashboards.")])]),t._v(" "),e("h3",{attrs:{id:"substituting-for-sub-query"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#substituting-for-sub-query"}},[t._v("#")]),t._v(" Substituting for sub-query")]),t._v(" "),e("p",[t._v("IoTDB does not support sub queries. We can get the same functionality by creating a CQ as a sub query and store its result into other time series and then querying from those time series again will be like doing nested sub query.")]),t._v(" "),e("h4",{attrs:{id:"example"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#example"}},[t._v("#")]),t._v(" Example")]),t._v(" "),e("p",[t._v("IoTDB does not accept the following query with a nested sub query. The query calculates the average number of non-null values of "),e("code",[t._v("s1")]),t._v(" at 30 minute intervals:")]),t._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("avg")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("count_s1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" count_s1 "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sg"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("d "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v("m"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("To get the same results:")]),t._v(" "),e("p",[e("strong",[t._v("1. Create a CQ")])]),t._v(" "),e("p",[t._v("This step performs the nested sub query in from clause of the query above. The following CQ automatically calculates the number of non-null values of "),e("code",[t._v("s1")]),t._v(" at 30 minute intervals and writes those counts into the new "),e("code",[t._v("root.sg_count.d.count_s1")]),t._v(" time series.")]),t._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" CQ s1_count_cq \n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BEGIN")]),t._v(" \n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sg_count"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("d"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("count_s1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sg"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("d\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v("m"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("END")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br")])]),e("p",[e("strong",[t._v("2. Query the CQ results")])]),t._v(" "),e("p",[t._v("Next step performs the avg([...]) part of the outer query above.")]),t._v(" "),e("p",[t._v("Query the data in the time series "),e("code",[t._v("root.sg_count.d.count_s1")]),t._v(" to calculate the average of it:")]),t._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("avg")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("count_s1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sg_count"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("d"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("h2",{attrs:{id:"system-parameter-configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#system-parameter-configuration"}},[t._v("#")]),t._v(" System Parameter Configuration")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("Name")]),t._v(" "),e("th",[t._v("Description")]),t._v(" "),e("th",[t._v("Data Type")]),t._v(" "),e("th",[t._v("Default Value")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("continuous_query_submit_thread")])]),t._v(" "),e("td",[t._v("The number of threads in the scheduled thread pool that submit continuous query tasks periodically")]),t._v(" "),e("td",[t._v("int32")]),t._v(" "),e("td",[t._v("2")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("continuous_query_min_every_interval_in_ms")])]),t._v(" "),e("td",[t._v("The minimum value of the continuous query execution time interval")]),t._v(" "),e("td",[t._v("duration")]),t._v(" "),e("td",[t._v("1000")])])])])])}),[],!1,null,null,null);e.default=n.exports}}]);