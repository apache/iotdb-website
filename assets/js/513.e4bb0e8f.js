(window.webpackJsonp=window.webpackJsonp||[]).push([[513],{1140:function(t,e,i){"use strict";i.r(e);var a=i(83),l=Object(a.a)({},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[i("h1",{attrs:{id:"时间分区"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#时间分区"}},[t._v("#")]),t._v(" 时间分区")]),t._v(" "),i("h2",{attrs:{id:"主要功能"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#主要功能"}},[t._v("#")]),t._v(" 主要功能")]),t._v(" "),i("p",[t._v("时间分区按照时间分割数据，一个时间分区用于保存某个时间范围内的所有数据。时间分区编号使用自然数表示，0 表示 1970 年 1 月 1 日，每隔 partition_interval 秒后加一。数据通过计算 timestamp / partition_interval 得到自己所在的时间分区编号，主要配置项如下所示：")]),t._v(" "),i("p",[t._v("注意：当前不建议开启此功能。 如果打开，请计算合适的 concurrent_writing_time_partition 和 wal_buffer_size, 计算公式如 wal_buffer_size = MaxDirectMemorySizeInBytes * 0.3 / (storage_group_num * virtual_storage_group_num) / concurrent_writing_time_partition")]),t._v(" "),i("ul",[i("li",[t._v("enable_partition")])]),t._v(" "),i("table",[i("thead",[i("tr",[i("th",{staticStyle:{"text-align":"center"}},[t._v("名字")]),t._v(" "),i("th",{staticStyle:{"text-align":"left"}},[t._v("enable_partition")])])]),t._v(" "),i("tbody",[i("tr",[i("td",{staticStyle:{"text-align":"center"}},[t._v("描述")]),t._v(" "),i("td",{staticStyle:{"text-align":"left"}},[t._v("是否开启将数据按时间分区存储的功能，如果关闭，所有数据都属于分区 0 (不建议开启此功能。 如果打开，请计算合适的 concurrent_writing_time_partition 和 wal_buffer_size)")])]),t._v(" "),i("tr",[i("td",{staticStyle:{"text-align":"center"}},[t._v("类型")]),t._v(" "),i("td",{staticStyle:{"text-align":"left"}},[t._v("Bool")])]),t._v(" "),i("tr",[i("td",{staticStyle:{"text-align":"center"}},[t._v("默认值")]),t._v(" "),i("td",{staticStyle:{"text-align":"left"}},[t._v("false")])]),t._v(" "),i("tr",[i("td",{staticStyle:{"text-align":"center"}},[t._v("改后生效方式")]),t._v(" "),i("td",{staticStyle:{"text-align":"left"}},[t._v("仅允许在第一次启动服务前修改")])])])]),t._v(" "),i("ul",[i("li",[t._v("partition_interval")])]),t._v(" "),i("table",[i("thead",[i("tr",[i("th",{staticStyle:{"text-align":"center"}},[t._v("名字")]),t._v(" "),i("th",{staticStyle:{"text-align":"left"}},[t._v("partition_interval")])])]),t._v(" "),i("tbody",[i("tr",[i("td",{staticStyle:{"text-align":"center"}},[t._v("描述")]),t._v(" "),i("td",{staticStyle:{"text-align":"left"}},[t._v("存储组分区的时间段长度，用户指定的存储组下会使用该时间段进行分区，单位：秒")])]),t._v(" "),i("tr",[i("td",{staticStyle:{"text-align":"center"}},[t._v("类型")]),t._v(" "),i("td",{staticStyle:{"text-align":"left"}},[t._v("Int64")])]),t._v(" "),i("tr",[i("td",{staticStyle:{"text-align":"center"}},[t._v("默认值")]),t._v(" "),i("td",{staticStyle:{"text-align":"left"}},[t._v("604800")])]),t._v(" "),i("tr",[i("td",{staticStyle:{"text-align":"center"}},[t._v("改后生效方式")]),t._v(" "),i("td",{staticStyle:{"text-align":"left"}},[t._v("仅允许在第一次启动服务前修改")])])])]),t._v(" "),i("h2",{attrs:{id:"配置示例"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#配置示例"}},[t._v("#")]),t._v(" 配置示例")]),t._v(" "),i("p",[t._v("开启时间分区功能，并设置 partition_interval 为 86400（一天），则数据的分布情况如下图所示：")]),t._v(" "),i("img",{staticStyle:{width:"100%","max-width":"800px","max-height":"600px","margin-left":"auto","margin-right":"auto",display:"block"},attrs:{src:"https://github.com/apache/iotdb-bin-resources/blob/main/docs/UserGuide/Data%20Concept/Time-Partition/time_partition_example.png?raw=true",alt:"time partition example"}}),t._v(" "),i("ul",[i("li",[i("p",[t._v("插入一条时间戳为 0 的数据，计算 0 / 86400 = 0，则该数据会被存储到 0 号文件夹下的TsFile中")])]),t._v(" "),i("li",[i("p",[t._v("插入一条时间戳为 1609459200010 的数据，计算 1609459200010 / 86400 = 18628，则该数据会被存储到 18628 号文件夹下的TsFile中")])])]),t._v(" "),i("h2",{attrs:{id:"使用建议"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#使用建议"}},[t._v("#")]),t._v(" 使用建议")]),t._v(" "),i("p",[t._v("使用时间分区功能时，建议同时打开 Memtable 的定时刷盘功能和 TsFileProcessor 的定时关闭功能，共 9 个相关配置参数（详情见 "),i("RouterLink",{attrs:{to:"/zh/UserGuide/Master/Reference/Config-Manual.html"}},[t._v("timed_flush与timed_close配置项")]),t._v("）。")],1),t._v(" "),i("ul",[i("li",[i("p",[t._v("enable_timed_flush_unseq_memtable: 是否开启乱序 Memtable 的定时刷盘，默认打开。")])]),t._v(" "),i("li",[i("p",[t._v("enable_timed_flush_seq_memtable: 是否开启顺序 Memtable 的定时刷盘，默认关闭。应当在开启时间分区后打开，定时刷盘非活跃时间分区下的 Memtable，为定时关闭 TsFileProcessor 作准备。")])]),t._v(" "),i("li",[i("p",[t._v("enable_timed_close_tsfile: 是否开启 TsFileProcessor 的定时关闭，默认关闭。应当在开启时间分区后打开，定时关闭非活跃时间分区下的 TsFileProcessor，减少内存占用。")])])])])}),[],!1,null,null,null);e.default=l.exports}}]);