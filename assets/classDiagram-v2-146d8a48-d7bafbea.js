import{y as B,T as k,S as I}from"./styles-55d85316-3ed063ea.js";import{e as p,t as i,n as x,j as M,g as R,T as A,f as D,I as $,d as E}from"./mermaid.esm.min-8dd16426.js";import{A as j}from"./layout-d6d8be39-6f9d9a33.js";import{h as q}from"./index-e6caf2ad-2f576b31.js";import"./app-9d916670.js";import"./framework-6055ecdb.js";import"./isPlainObject-a5cb4071-52f9f894.js";import"./array-2ff2c7a6-ffeda358.js";import"./constant-2fe7eae5-45b4460e.js";import"./edges-0979260b-a8461b22.js";import"./svgDraw-c034b55e-5610e118.js";const N=o=>E.sanitizeText(o,i());let T={dividerMargin:10,padding:5,textHeight:10,curve:void 0};const H=function(o,a,f,n){const e=Object.keys(o);p.info("keys:",e),p.info(o),e.forEach(function(s){var l,r;const t=o[s];let y="";t.cssClasses.length>0&&(y=y+" "+t.cssClasses.join(" "));const d={labelStyle:"",style:""},u=t.label??t.id,c=0,g="class_box",b={labelStyle:d.labelStyle,shape:g,labelText:N(u),classData:t,rx:c,ry:c,class:y,style:d.style,id:t.id,domId:t.domId,tooltip:n.db.getTooltip(t.id)||"",haveCallback:t.haveCallback,link:t.link,width:t.type==="group"?500:void 0,type:t.type,padding:((l=i().flowchart)==null?void 0:l.padding)??((r=i().class)==null?void 0:r.padding)};a.setNode(t.id,b),p.info("setNode",b)})},P=function(o,a,f,n){p.info(o),o.forEach(function(e,s){var l,r;const t=e,y="",d={labelStyle:"",style:""},u=t.text,c=0,g="note",b={labelStyle:d.labelStyle,shape:g,labelText:N(u),noteData:t,rx:c,ry:c,class:y,style:d.style,id:t.id,domId:t.id,tooltip:"",type:"note",padding:((l=i().flowchart)==null?void 0:l.padding)??((r=i().class)==null?void 0:r.padding)};if(a.setNode(t.id,b),p.info("setNode",b),!t.class||!(t.class in n))return;const m=f+s,v={id:`edgeNote${m}`,classes:"relation",pattern:"dotted",arrowhead:"none",startLabelRight:"",endLabelLeft:"",arrowTypeStart:"none",arrowTypeEnd:"none",style:"fill:none",labelStyle:"",curve:A(T.curve,D)};a.setEdge(t.id,t.class,v,m)})},_=function(o,a){const f=i().flowchart;let n=0;o.forEach(function(e){var s;n++;const l={classes:"relation",pattern:e.relation.lineType==1?"dashed":"solid",id:"id"+n,arrowhead:e.type==="arrow_open"?"none":"normal",startLabelRight:e.relationTitle1==="none"?"":e.relationTitle1,endLabelLeft:e.relationTitle2==="none"?"":e.relationTitle2,arrowTypeStart:L(e.relation.type1),arrowTypeEnd:L(e.relation.type2),style:"fill:none",labelStyle:"",curve:A(f==null?void 0:f.curve,D)};if(p.info(l,e),e.style!==void 0){const r=$(e.style);l.style=r.style,l.labelStyle=r.labelStyle}e.text=e.title,e.text===void 0?e.style!==void 0&&(l.arrowheadStyle="fill: #333"):(l.arrowheadStyle="fill: #333",l.labelpos="c",((s=i().flowchart)==null?void 0:s.htmlLabels)??i().htmlLabels?(l.labelType="html",l.label='<span class="edgeLabel">'+e.text+"</span>"):(l.labelType="text",l.label=e.text.replace(E.lineBreakRegex,`
`),e.style===void 0&&(l.style=l.style||"stroke: #333; stroke-width: 1.5px;fill:none"),l.labelStyle=l.labelStyle.replace("color:","fill:"))),a.setEdge(e.id1,e.id2,l,n)})},z=function(o){T={...T,...o}},F=function(o,a,f,n){p.info("Drawing class - ",a);const e=i().flowchart??i().class,s=i().securityLevel;p.info("config:",e);const l=(e==null?void 0:e.nodeSpacing)??50,r=(e==null?void 0:e.rankSpacing)??50,t=new j({multigraph:!0,compound:!0}).setGraph({rankdir:n.db.getDirection(),nodesep:l,ranksep:r,marginx:8,marginy:8}).setDefaultEdgeLabel(function(){return{}}),y=n.db.getClasses(),d=n.db.getRelations(),u=n.db.getNotes();p.info(d),H(y,t,a,n),_(d,t),P(u,t,d.length+1,y);let c;s==="sandbox"&&(c=x("#i"+a));const g=s==="sandbox"?x(c.nodes()[0].contentDocument.body):x("body"),b=g.select(`[id="${a}"]`),m=g.select("#"+a+" g");if(q(m,t,["aggregation","extension","composition","dependency","lollipop"],"classDiagram",a),M.insertTitle(b,"classTitleText",(e==null?void 0:e.titleTopMargin)??5,n.db.getDiagramTitle()),R(t,b,e==null?void 0:e.diagramPadding,e==null?void 0:e.useMaxWidth),!(e!=null&&e.htmlLabels)){const v=s==="sandbox"?c.nodes()[0].contentDocument:document,C=v.querySelectorAll('[id="'+a+'"] .edgeLabel .label');for(const w of C){const S=w.getBBox(),h=v.createElementNS("http://www.w3.org/2000/svg","rect");h.setAttribute("rx",0),h.setAttribute("ry",0),h.setAttribute("width",S.width),h.setAttribute("height",S.height),w.insertBefore(h,w.firstChild)}}};function L(o){let a;switch(o){case 0:a="aggregation";break;case 1:a="extension";break;case 2:a="composition";break;case 3:a="dependency";break;case 4:a="lollipop";break;default:a="none"}return a}const G={setConf:z,draw:F},te={parser:B,db:k,renderer:G,styles:I,init:o=>{o.class||(o.class={}),o.class.arrowMarkerAbsolute=o.arrowMarkerAbsolute,k.clear()}};export{te as diagram};